(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    272620,       6639]
NotebookOptionsPosition[    260558,       6439]
NotebookOutlinePosition[    260955,       6455]
CellTagsIndexPosition[    260912,       6452]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.81584417394973*^9, 3.815844180510105*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e3f8dcf6-1e19-4642-ae7e-9f7e95e14283"],

Cell[BoxData[
 RowBox[{
  RowBox[{"linked", "=", 
   RowBox[{"ValueQ", "[", "linked`$Evaluatenotebook", "]"}]}], ";", 
  RowBox[{"Clear", "[", "linked`$Evaluatenotebook", "]"}]}]], "Input",
 CellChangeTimes->{{3.8158445540084677`*^9, 3.815844554028469*^9}, {
  3.815845198451328*^9, 3.8158452175714216`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ce1fa6ed-5482-4778-8218-a3b6aa517a05"],

Cell[BoxData[
 RowBox[{"vdtdz", "=", 
  RowBox[{"If", "[", 
   RowBox[{"linked", ",", "linked`vdtdz", ",", "1.0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815844560810857*^9, 3.815844560834858*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"80b701c8-5fef-4658-8417-51f380dc3e67"],

Cell[CellGroupData[{

Cell["\<\
1. IMPORTANT: Definition of an appropriate derivative operator for the code\
\>", "Subsubsection",
 CellChangeTimes->{
  3.810267348659856*^9},ExpressionUUID->"005c8f89-f0db-439f-b767-\
5aa456a6ad0e"],

Cell["\<\
In this notebook, I define a derivative operator that can take care of \
derivatives with respect to terms enclosed in the Re[...] and Im[...] \
operators picking the real and imaginary parts of expressions. This operator \
is necessary for the current and the following notebooks, hence its placement \
here. Please execute this before any of the other commands in any of the \
notebooks.\
\>", "Text",
 CellChangeTimes->{{3.8044283964461365`*^9, 3.804428416732297*^9}, {
  3.805030221398723*^9, 
  3.8050302935188484`*^9}},ExpressionUUID->"d69475a1-58a8-4587-927f-\
5e441a061c96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deriv", "[", 
   RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"expr", ",", "var"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Re", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"D", "[", 
         RowBox[{"e", ",", "var"}], "]"}], "]"}], "/", 
       RowBox[{"D", "[", 
        RowBox[{"e", ",", "var"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Im", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"D", "[", 
         RowBox[{"e", ",", "var"}], "]"}], "]"}], "/", 
       RowBox[{"D", "[", 
        RowBox[{"e", ",", "var"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Arg", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"e", ",", "var"}], "]"}], "/", "e"}], "]"}], "/", 
       RowBox[{"D", "[", 
        RowBox[{"e", ",", "var"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "e", "]"}], " ", 
          RowBox[{"Re", "[", 
           RowBox[{"D", "[", 
            RowBox[{"e", ",", "var"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Im", "[", "e", "]"}], " ", 
          RowBox[{"Im", "[", 
           RowBox[{"D", "[", 
            RowBox[{"e", ",", "var"}], "]"}], "]"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", "e", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{"e", ",", "var"}], "]"}]}], ")"}]}]}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.804428403689551*^9, 3.8044284037185526`*^9}, {
   3.810280159528596*^9, 3.810280200834958*^9}, 3.81028029754449*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"0f3e5c72-fbeb-44d3-943e-11fa025e28dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of theory parameters", "Section",
 CellChangeTimes->{
  3.821114938151041*^9},ExpressionUUID->"8200e51d-ad61-4d81-8173-\
d55539dffd4f"],

Cell[CellGroupData[{

Cell["Definition of the Weinberg angle, g and g\[CloseCurlyQuote]", \
"Subsection",
 CellChangeTimes->{{3.821114945512038*^9, 3.8211149513218613`*^9}, {
  3.821114984040275*^9, 
  3.821114991751889*^9}},ExpressionUUID->"51c6f653-6300-48be-a61d-\
87ae8332922e"],

Cell["\<\
The sphaleron is usually computed in the limit of vanishing Weinberg angle, \
which implies a vanishing U(1) g\[CloseCurlyQuote] coupling. In this way, the \
U(1) field completely decouples from the SU(2) and Higgs fields. This is the \
ansatz we have chosen (as in most literature we are aware of) to solve the \
equations of motion in order to calculate the sphaleron energy. 
However, whereas it would be consistent to drop g\[CloseCurlyQuote] \
everywhere in our calculation, some papers do evaluate the sphaleron energy \
in the U(1) field decoupling limit but with g\[CloseCurlyQuote] keeping its \
physical value while defining the effective potential. The reason for this is \
that, whereas the U(1) field barely contributes to the sphaleron energy (and \
hence the EoMs for the U(1) fields may be dropped), g\[CloseCurlyQuote] may \
have sizeable effects on the shape of the potential. If the nucleation \
temperatures calculated in CosmoTransitions correspond to the model with a \
physical g\[CloseCurlyQuote] coupling, it may be wise to  keep defining the \
effective potential accordingly in this code. The user can choose which \
approach to follow here.\
\>", "Text",
 CellChangeTimes->{{3.82111508698676*^9, 
  3.821115611632255*^9}},ExpressionUUID->"f5ebddf9-e65b-493b-9208-\
43e162055216"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WeinbergTheta", "=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"80.38", "/", "91.19"}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{"Sqrt", "[", "0.22290", "]"}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CouplingG", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "*", "80.38"}], ")"}], "/", "246.22"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U1Flag", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"U1Flag", "\[Equal]", "0"}], ",", 
    RowBox[{"CouplingGprime", "=", "0"}], ",", 
    RowBox[{"CouplingGprime", "=", 
     RowBox[{"CouplingG", "*", 
      RowBox[{"Tan", "[", "WeinbergTheta", "]"}]}]}]}], "]"}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CouplingGPrime", "=", "0"}], ";"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8211150019925337`*^9, 3.821115045059568*^9}, {
  3.824059010654593*^9, 3.824059069174144*^9}, {3.824059113274494*^9, 
  3.8240591222347183`*^9}, {3.824059168735179*^9, 3.824059171533868*^9}, {
  3.824059603794335*^9, 3.824059604092493*^9}, {3.824061839484852*^9, 
  3.8240618396436357`*^9}, {3.824065018630705*^9, 3.824065018829693*^9}, {
  3.825618628944141*^9, 
  3.825618629010798*^9}},ExpressionUUID->"516e22b2-d068-4d4e-aaab-\
511a43350b92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<CouplingGprime: \>\"", ",", "CouplingGPrime"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8240618481849546`*^9, 
  3.82406186427404*^9}},ExpressionUUID->"1b4e8f01-86f8-4573-868e-\
b26f937b951e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Definition of the remaining parameters appearing in the model\
\>", "Subsection",
 CellChangeTimes->{{3.821115638946197*^9, 
  3.821115657639512*^9}},ExpressionUUID->"92edfdc3-d4c2-41cd-bfd2-\
187b777610b8"],

Cell["\<\
The first thing is to define the numerical values of the theory parameters \
(Table 1, p.5).\
\>", "Text",
 CellChangeTimes->{{3.8050284328354235`*^9, 3.8050284430540075`*^9}, {
  3.805028496488064*^9, 
  3.805028501385344*^9}},ExpressionUUID->"bf73d1e6-eed7-4ff8-998c-\
13a6b9e0ad2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"g", ",", 
    SubscriptBox["y", "t"], ",", "gprime", ",", "Q"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "finiteTv", ",", "finiteTx", ",", "singletvev", ",", "muH", ",", "muS", 
    ",", "Lambda", ",", "LambdaS", ",", "Alpha", ",", "Rho", ",", "Omega", 
    ",", "Params", ",", "dParams"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1", "=", "125"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"higgsvev", "=", "246.22"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "=", "higgsvev"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"singletvev", "=", 
   RowBox[{"mmalist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "=", "singletvev"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muH", "=", 
   RowBox[{"plist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muS", "=", 
   RowBox[{"plist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lambda", "=", 
   RowBox[{"plist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "3"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LambdaS", "=", 
   RowBox[{"plist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Alpha", "=", 
   RowBox[{"plist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "5"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rho", "=", 
   RowBox[{"plist", "[", 
    RowBox[{"[", 
     RowBox[{"linked`vdtdz", ",", "6"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Omega", "=", 
    RowBox[{"plist", "[", 
     RowBox[{"[", 
      RowBox[{"linked`vdtdz", ",", "7"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ScalarVEV", "=", "singletvev"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HiggsVEV", "=", "higgsvev"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TopYukawa", "=", 
    RowBox[{
     RowBox[{"Sqrt", "[", "2", "]"}], "*", 
     FractionBox["173", "v"]}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"For", " ", "now", " ", "as", " ", "a", " ", "test"}], ",", " ", 
     RowBox[{
     "since", " ", "I", " ", "did", " ", "not", " ", "find", " ", "a", " ", 
      "defined", " ", "numerical", " ", "value", " ", "for", " ", "the", " ", 
      "top", " ", "quark", " ", 
      RowBox[{"mass", " ", "/", " ", "Yukawa"}], " ", 
      RowBox[{"coupling", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rho", "=", 
      RowBox[{"-", "272.22"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Alpha", "=", 
      RowBox[{"-", "38.89"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"largeOmega", "=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      SuperscriptBox["HiggsVEV", "2"], "+", 
      SuperscriptBox["ScalarVEV", "2"]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ScaleQ", "=", "HiggsVEV"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8006103683468313`*^9, 3.8006104171236215`*^9}, {
   3.8006130901485095`*^9, 3.800613105958414*^9}, {3.800613443079696*^9, 
   3.8006134437537346`*^9}, {3.800613517938978*^9, 3.8006135187580247`*^9}, {
   3.800616192408949*^9, 3.800616196186165*^9}, 3.8012068249007854`*^9, {
   3.801207233642164*^9, 3.8012074456332893`*^9}, {3.8012074909348803`*^9, 
   3.8012075196125207`*^9}, {3.8014789477067337`*^9, 
   3.8014789503868866`*^9}, {3.801479367234729*^9, 3.8014793694828577`*^9}, {
   3.801481904366845*^9, 3.801481982699325*^9}, {3.8014820138271055`*^9, 
   3.8014820583216505`*^9}, 3.8014821237153907`*^9, {3.801482244881321*^9, 
   3.801482255773944*^9}, {3.8042436231793118`*^9, 3.8042436348709803`*^9}, {
   3.804245860478278*^9, 3.804245883078571*^9}, 3.808034396113943*^9, 
   3.808034544991459*^9, {3.8085998065951834`*^9, 3.8085998091503296`*^9}, {
   3.8091855725924835`*^9, 3.809185623793412*^9}, {3.809185707276187*^9, 
   3.8091857342407293`*^9}, {3.81143611455392*^9, 3.811436169761077*^9}, {
   3.811436605914709*^9, 3.811436634483343*^9}, {3.811777211007373*^9, 
   3.811777295037179*^9}, {3.811777503867123*^9, 3.8117775103714952`*^9}, {
   3.8123618789150844`*^9, 3.812361918414354*^9}, {3.812362133810932*^9, 
   3.8123621599721785`*^9}, {3.815897473913743*^9, 3.81589747420776*^9}, {
   3.8158975980468426`*^9, 3.815897816912361*^9}, 3.8158986373672886`*^9, {
   3.8159228379244814`*^9, 3.815922858844678*^9}, {3.815922952087011*^9, 
   3.815922955075182*^9}, {3.8159236174140654`*^9, 3.8159236404243813`*^9}, {
   3.82084330703198*^9, 3.82084331069116*^9}, {3.821114865432913*^9, 
   3.821114902028903*^9}, 3.821114979993333*^9, {3.821115681960959*^9, 
   3.82111569584022*^9}, {3.823965842152091*^9, 3.823965861144176*^9}, {
   3.824058756474669*^9, 3.824058757176786*^9}, {3.824386235351307*^9, 
   3.8243862503498993`*^9}, {3.8291622980358267`*^9, 
   3.829162300507183*^9}},ExpressionUUID->"ea902132-9751-4c5c-a0ae-\
f60e1094074c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thermal resummation scheme", "Section",
 CellChangeTimes->{{3.8211133424739857`*^9, 3.821113346179144*^9}, {
  3.821113394192172*^9, 
  3.821113395242248*^9}},ExpressionUUID->"80e875b1-1e31-44c6-9432-\
644fe51214b4"],

Cell[TextData[{
 "Two different - and in principle physically inequivalent - thermal \
resummation schemes appear in literature. In the Arnold-Espinosa approach, \
daisy diagrams are resummed by adding a further \
\[OpenCurlyDoubleQuote]daisy/ring term\[CloseCurlyDoubleQuote] to the \
effective potential. In the Parwani method, the zero-temperature, field \
dependent masses that appear in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "CW"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e86e0541-9c56-48b6-abb4-c4f81edba662"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "T"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "49a7c7a4-ffe1-4d13-b1b0-714fb6ec50c8"],
 " are substituted by the thermally corrected expressions (with an explicit \
temperature dependence). The user may decide which approach to use by setting \
the correct resummationFlag: 0 for Arnold-Espinosa, 1 for Parwani."
}], "Text",
 CellChangeTimes->{{3.821115706791823*^9, 3.82111588579226*^9}, {
  3.8211159649795713`*^9, 
  3.821115969344836*^9}},ExpressionUUID->"ee3448e6-f336-421a-969f-\
dee7c36fa892"],

Cell[BoxData[
 RowBox[{
  RowBox[{"resummationFlag", "=", "1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8211133579112988`*^9, 3.821113423626773*^9}, {
  3.821113503792315*^9, 3.821113512741911*^9}, {3.821115890832481*^9, 
  3.8211158913923607`*^9}, {3.825615331283607*^9, 
  3.825615331462061*^9}},ExpressionUUID->"e558edde-2c19-4c17-8701-\
81df320758b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation of the tree-level potential", "Section",
 CellChangeTimes->{
  3.8211134460458403`*^9},ExpressionUUID->"2c355881-0a0b-4a8b-ad8a-\
8f0f687b6ada"],

Cell["\<\
Here, we will provide the tree-level potential. Only the CP-even part \
contributes dynamically (the remaining fields are assumed to be zero at the \
vev, hence no contribution to the tree-level potential). It is given by the \
following expression:\
\>", "Text",
 CellChangeTimes->{{3.8050283079762816`*^9, 3.8050283457554426`*^9}, {
  3.805028420047692*^9, 3.805028422079808*^9}, {3.8123609991065254`*^9, 
  3.8123610419428043`*^9}},ExpressionUUID->"e3e28ffc-dbf1-4f79-adb7-\
0b622c76c8ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Params", "=", 
    RowBox[{"{", 
     RowBox[{"(*", "mu1Sq", "*)"}], 
     RowBox[{
      RowBox[{"muh2", "\[Rule]", "muH"}], ",", 
      RowBox[{"(*", "mu2Sq", "*)"}], 
      RowBox[{"mus2", "\[Rule]", "muS"}], ",", 
      RowBox[{"(*", "\[Lambda]", "*)"}], 
      RowBox[{"\[Lambda]h", "\[Rule]", "Lambda"}], ",", 
      RowBox[{"(*", 
       SubscriptBox["\[Lambda]", "S"], "*)"}], 
      RowBox[{"\[Lambda]s", "\[Rule]", "LambdaS"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "Alpha"}], ",", 
      RowBox[{"\[Rho]", "\[Rule]", "Rho"}], ",", 
      RowBox[{"\[Omega]", "\[Rule]", "Omega"}], ",", 
      RowBox[{
       SubscriptBox["y", "t"], "\[Rule]", "TopYukawa"}], ",", 
      RowBox[{"g", "\[Rule]", "CouplingG"}], ",", 
      RowBox[{"gp", "\[Rule]", "CouplingGprime"}], ",", 
      RowBox[{"Q", "\[Rule]", "ScaleQ"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"treepotential", "[", 
    RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]h", "*", 
     FractionBox[
      SuperscriptBox["h1", "4"], "4"]}], "-", 
    RowBox[{"muh2", "*", 
     FractionBox[
      SuperscriptBox["h1", "2"], "2"]}], "+", 
    RowBox[{"\[Omega]", "*", 
     FractionBox[
      SuperscriptBox["h1", "2"], "2"], "*", 
     SuperscriptBox["s", "2"]}], "+", 
    RowBox[{"\[Rho]", "*", 
     FractionBox[
      SuperscriptBox["h1", "2"], "2"], "*", "s"}], "+", 
    RowBox[{
     FractionBox["\[Lambda]s", "4"], "*", 
     SuperscriptBox["s", "4"]}], "-", 
    RowBox[{
     FractionBox["\[Alpha]", "3"], "*", 
     SuperscriptBox["s", "3"]}], "-", 
    RowBox[{
     FractionBox["mus2", "2"], "*", 
     SuperscriptBox["s", "2"]}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8050283805644336`*^9, 3.805028391481058*^9}, {
   3.810112372512781*^9, 3.810112385855544*^9}, 3.8123621280389223`*^9, {
   3.812362162858184*^9, 3.8123622584405518`*^9}, {3.8123623682267466`*^9, 
   3.8123624241372447`*^9}, {3.812362707778943*^9, 3.812362713488553*^9}, {
   3.8123628359536176`*^9, 3.812362861463663*^9}, 3.821111828552186*^9, 
   3.8211134561394157`*^9, 3.821114798742435*^9, {3.823354008720963*^9, 
   3.823354045347705*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f4abc137-58b6-4bd4-9c2b-d046b2dd6711"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mass matrices at T = 0", "Section",
 CellChangeTimes->{{3.820856806548603*^9, 3.8208568089864683`*^9}, {
  3.8208569584689074`*^9, 
  3.8208569633227386`*^9}},ExpressionUUID->"86412d4e-daa1-47a9-beb5-\
f22fec899bc5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"masstsq", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], "*", 
    SuperscriptBox[
     SubscriptBox["y", "t"], "2"], "*", 
    SuperscriptBox["h", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mass\[Gamma]sq", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"h", "^", "2"}], "8"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", "^", "2"}], "+", 
       RowBox[{"gp", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", "^", "2"}], "+", 
       RowBox[{"gp", "^", "2"}]}], ")"}], "*", 
     RowBox[{"T", "^", "2"}]}], "-", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h", "^", "2"}], "+", 
           RowBox[{"8", "*", 
            RowBox[{"T", "^", "2"}]}]}], ")"}], "^", "2"}], "64"], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "^", "2"}], "+", 
          RowBox[{"gp", "^", "2"}]}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"g", "^", "2"}], "*", 
       RowBox[{"gp", "^", "2"}], "*", 
       RowBox[{"T", "^", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h", "^", "2"}], "+", 
         RowBox[{"4", "*", 
          RowBox[{"T", "^", "2"}]}]}], ")"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"massZsq", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"h", "^", "2"}], "8"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", "^", "2"}], "+", 
       RowBox[{"gp", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", "^", "2"}], "+", 
       RowBox[{"gp", "^", "2"}]}], ")"}], "*", 
     RowBox[{"T", "^", "2"}]}], "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h", "^", "2"}], "+", 
           RowBox[{"8", "*", 
            RowBox[{"T", "^", "2"}]}]}], ")"}], "^", "2"}], "64"], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "^", "2"}], "+", 
          RowBox[{"gp", "^", "2"}]}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"g", "^", "2"}], "*", 
       RowBox[{"gp", "^", "2"}], "*", 
       RowBox[{"T", "^", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h", "^", "2"}], "+", 
         RowBox[{"4", "*", 
          RowBox[{"T", "^", "2"}]}]}], ")"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"massWsq", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox["g", "2"], "4"], 
     SuperscriptBox["h", "2"]}], "+", 
    RowBox[{
     FractionBox["11", "6"], "*", 
     SuperscriptBox["g", "2"], "*", 
     SuperscriptBox["T", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"massHiggssq", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "muh2"}], "-", "mus2", "-", 
      RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "+", 
      RowBox[{"s", " ", "\[Rho]"}], "+", 
      RowBox[{
       SuperscriptBox["h", "2"], " ", "\[Omega]"}], "+", 
      RowBox[{
       SuperscriptBox["s", "2"], " ", "\[Omega]"}], "+", 
      RowBox[{
       SuperscriptBox["T", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["g", "2"]}], "16"], "+", 
         FractionBox[
          RowBox[{"1", "*", 
           RowBox[{"gp", "^", "2"}]}], "16"], "+", 
         FractionBox["\[Lambda]h", "2"], "+", 
         FractionBox["\[Omega]", "12"], "+", 
         FractionBox[
          SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["T", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["\[Omega]", "3"], "+", 
         FractionBox["\[Lambda]s", "4"]}], ")"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["s", "2"], " ", "\[Lambda]s"}], "-", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"muh2", "+", "mus2", "+", 
            RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "-", 
            RowBox[{"s", " ", "\[Rho]"}], "-", 
            RowBox[{
             SuperscriptBox["h", "2"], " ", "\[Omega]"}], "-", 
            RowBox[{
             SuperscriptBox["s", "2"], " ", "\[Omega]"}], "-", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["g", "2"]}], "16"], "+", 
               FractionBox[
                RowBox[{"1", "*", 
                 RowBox[{"gp", "^", "2"}]}], "16"], "+", 
               FractionBox["\[Lambda]h", "2"], "+", 
               FractionBox["\[Omega]", "12"], "+", 
               FractionBox[
                SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["\[Omega]", "3"], "+", 
               FractionBox["\[Lambda]s", "4"]}], ")"}]}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["s", "2"], " ", "\[Lambda]s"}]}], ")"}], "2"], 
         "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"h", " ", "\[Rho]"}], "+", 
                RowBox[{"2", " ", "h", " ", "s", " ", "\[Omega]"}]}], ")"}], 
              "2"]}], "+", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "muh2"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "+", 
               RowBox[{"s", " ", "\[Rho]"}], "+", 
               RowBox[{
                SuperscriptBox["s", "2"], " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["\[Omega]", "3"], "+", 
               FractionBox["\[Lambda]s", "4"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["T", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["g", "2"]}], "16"], "+", 
               FractionBox[
                RowBox[{"1", "*", 
                 RowBox[{"gp", "^", "2"}]}], "16"], "+", 
               FractionBox["\[Lambda]h", "2"], "+", 
               FractionBox["\[Omega]", "12"], "+", 
               FractionBox[
                SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["\[Omega]", "3"], "+", 
               FractionBox["\[Lambda]s", "4"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "muh2"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "+", 
               RowBox[{"s", " ", "\[Rho]"}], "+", 
               RowBox[{
                SuperscriptBox["s", "2"], " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "mus2"}], "-", 
               RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "+", 
               RowBox[{
                SuperscriptBox["h", "2"], " ", "\[Omega]"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["s", "2"], " ", "\[Lambda]s"}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["g", "2"]}], "16"], "+", 
               FractionBox[
                RowBox[{"1", "*", 
                 RowBox[{"gp", "^", "2"}]}], "16"], "+", 
               FractionBox["\[Lambda]h", "2"], "+", 
               FractionBox["\[Omega]", "12"], "+", 
               FractionBox[
                SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "mus2"}], "-", 
               RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "+", 
               RowBox[{
                SuperscriptBox["h", "2"], " ", "\[Omega]"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["s", "2"], " ", "\[Lambda]s"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"massSinglet", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "muh2"}], "-", "mus2", "-", 
      RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "+", 
      RowBox[{"s", " ", "\[Rho]"}], "+", 
      RowBox[{
       SuperscriptBox["h", "2"], " ", "\[Omega]"}], "+", 
      RowBox[{
       SuperscriptBox["s", "2"], " ", "\[Omega]"}], "+", 
      RowBox[{
       SuperscriptBox["T", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["g", "2"]}], "16"], "+", 
         FractionBox[
          RowBox[{"1", "*", 
           RowBox[{"gp", "^", "2"}]}], "16"], "+", 
         FractionBox["\[Lambda]h", "2"], "+", 
         FractionBox["\[Omega]", "12"], "+", 
         FractionBox[
          SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["T", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["\[Omega]", "3"], "+", 
         FractionBox["\[Lambda]s", "4"]}], ")"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["s", "2"], " ", "\[Lambda]s"}], "+", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"muh2", "+", "mus2", "+", 
            RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "-", 
            RowBox[{"s", " ", "\[Rho]"}], "-", 
            RowBox[{
             SuperscriptBox["h", "2"], " ", "\[Omega]"}], "-", 
            RowBox[{
             SuperscriptBox["s", "2"], " ", "\[Omega]"}], "-", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["g", "2"]}], "16"], "+", 
               FractionBox[
                RowBox[{"1", "*", 
                 RowBox[{"gp", "^", "2"}]}], "16"], "+", 
               FractionBox["\[Lambda]h", "2"], "+", 
               FractionBox["\[Omega]", "12"], "+", 
               FractionBox[
                SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["\[Omega]", "3"], "+", 
               FractionBox["\[Lambda]s", "4"]}], ")"}]}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["s", "2"], " ", "\[Lambda]s"}]}], ")"}], "2"], 
         "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"h", " ", "\[Rho]"}], "+", 
                RowBox[{"2", " ", "h", " ", "s", " ", "\[Omega]"}]}], ")"}], 
              "2"]}], "+", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "muh2"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "+", 
               RowBox[{"s", " ", "\[Rho]"}], "+", 
               RowBox[{
                SuperscriptBox["s", "2"], " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["\[Omega]", "3"], "+", 
               FractionBox["\[Lambda]s", "4"]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["T", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["g", "2"]}], "16"], "+", 
               FractionBox[
                RowBox[{"1", "*", 
                 RowBox[{"gp", "^", "2"}]}], "16"], "+", 
               FractionBox["\[Lambda]h", "2"], "+", 
               FractionBox["\[Omega]", "12"], "+", 
               FractionBox[
                SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["\[Omega]", "3"], "+", 
               FractionBox["\[Lambda]s", "4"]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "muh2"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "2"], " ", "\[Lambda]h"}], "+", 
               RowBox[{"s", " ", "\[Rho]"}], "+", 
               RowBox[{
                SuperscriptBox["s", "2"], " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "mus2"}], "-", 
               RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "+", 
               RowBox[{
                SuperscriptBox["h", "2"], " ", "\[Omega]"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["s", "2"], " ", "\[Lambda]s"}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["T", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["g", "2"]}], "16"], "+", 
               FractionBox[
                RowBox[{"1", "*", 
                 RowBox[{"gp", "^", "2"}]}], "16"], "+", 
               FractionBox["\[Lambda]h", "2"], "+", 
               FractionBox["\[Omega]", "12"], "+", 
               FractionBox[
                SubsuperscriptBox["y", "t", "2"], "4"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "mus2"}], "-", 
               RowBox[{"2", " ", "s", " ", "\[Alpha]"}], "+", 
               RowBox[{
                SuperscriptBox["h", "2"], " ", "\[Omega]"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["s", "2"], " ", "\[Lambda]s"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mass\[Phi]sq", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]h", "*", 
     SuperscriptBox["h", "2"]}], "-", "muh2", "+", 
    RowBox[{"\[Omega]", "*", 
     SuperscriptBox["s", "2"]}], "+", 
    RowBox[{"\[Rho]", "*", "s"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"3", "*", 
         SuperscriptBox["g", "2"]}], "16"], "+", 
       FractionBox[
        RowBox[{"1", "*", 
         RowBox[{"gp", "^", "2"}]}], "16"], "+", 
       FractionBox["\[Lambda]h", "2"], "+", 
       FractionBox[
        SuperscriptBox[
         SubscriptBox["y", "t"], "2"], "4"], "+", 
       FractionBox["\[Omega]", "12"]}], ")"}], "*", 
     SuperscriptBox["T", "2"]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820665039069099*^9, 3.820665147074265*^9}, {
   3.820665177225717*^9, 3.820665188355146*^9}, {3.8206652346263742`*^9, 
   3.820665289491926*^9}, {3.82066532398365*^9, 3.82066535150896*^9}, {
   3.820665410391677*^9, 3.820665537894129*^9}, {3.8206656701770697`*^9, 
   3.820665683490447*^9}, {3.820666025285605*^9, 3.820666053513895*^9}, {
   3.820666239296193*^9, 3.8206662460063667`*^9}, {3.8208568349514217`*^9, 
   3.820856938083585*^9}, {3.820856974479195*^9, 3.820857025606865*^9}, 
   3.820857244383297*^9, {3.820857320143406*^9, 3.820857352329009*^9}, {
   3.8208574012834387`*^9, 3.820857521987599*^9}, {3.8208576079720993`*^9, 
   3.8208576475017242`*^9}, {3.820869245947263*^9, 3.820869252608057*^9}, {
   3.820870975295776*^9, 3.820871014861006*^9}, {3.820871229578075*^9, 
   3.8208712474680977`*^9}, {3.820873070590296*^9, 3.820873178631083*^9}, {
   3.820873214341085*^9, 3.820873220665937*^9}, {3.820873471979154*^9, 
   3.820873564605185*^9}, 3.820931464383685*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"813d1975-4b0e-411e-8e5c-5984933fad38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculation of the 1-loop 0-temperature corrections (Coleman-Weinberg \
potential)\
\>", "Section",
 CellChangeTimes->{{3.82111347378557*^9, 
  3.821113484281927*^9}},ExpressionUUID->"9772c627-8d17-4696-895c-\
6af71d0d2573"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dof", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "top"], "=", 
       RowBox[{"-", "12"}]}], ",", 
      RowBox[{
       SubscriptBox["n", "Zboson"], "=", "3"}], ",", 
      RowBox[{
       SubscriptBox["n", "Wboson"], "=", "6"}], ",", 
      RowBox[{
       SubscriptBox["n", "Chiboson"], "=", "3"}], ",", 
      RowBox[{
       SubscriptBox["n", "Higgs"], "=", "1"}], ",", 
      RowBox[{
       SubscriptBox["n", "Singlet"], "=", "1"}], ",", 
      RowBox[{
       SubscriptBox["n", "Photon"], "=", "3"}]}], "}"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "list", " ", "with", " ", "the", " ", 
     "degrees", " ", "of", " ", "freedom", " ", "of", " ", "each", " ", 
     RowBox[{"particle", ".", " ", "The"}], " ", "order", " ", "is", " ", 
     "the", " ", "same", " ", "as", " ", "in", " ", "the", " ", "list", " ", 
     "with", " ", "the", " ", "masses"}], ";", " ", 
    RowBox[{"this", " ", "is", " ", 
     RowBox[{"important", "!"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", "x_", "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["x", "2"], 
      RowBox[{"64", 
       SuperscriptBox["\[Pi]", "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Log", "[", 
         RowBox[{
          FractionBox["x", 
           RowBox[{"Q", "^", "2"}]], "+", 
          RowBox[{"1", "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "100"}]}]}]}], "]"}], ")"}], "-", 
       FractionBox["3", "2"]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gtrans", "[", "x_", "]"}], ":=", 
    RowBox[{"Re", "[", 
     RowBox[{
      FractionBox[
       SuperscriptBox["x", "2"], 
       RowBox[{"64", 
        SuperscriptBox["\[Pi]", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Log", "[", 
          RowBox[{
           FractionBox["x", 
            RowBox[{"Q", "^", "2"}]], "+", 
           RowBox[{"1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "100"}]}]}]}], "]"}], ")"}], "-", 
        FractionBox["1", "2"]}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"resummationFlag", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CWV", "[", 
       RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        SubscriptBox["n", "top"], "*", 
        RowBox[{"G", "[", 
         RowBox[{"masstsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Zboson"], "-", "2"}], ")"}], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massZsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Zboson"], "-", "1"}], ")"}], "*", 
        RowBox[{"Gtrans", "[", 
         RowBox[{"massZsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Wboson"], "-", "4"}], ")"}], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massWsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Wboson"], "-", "2"}], ")"}], "*", 
        RowBox[{"Gtrans", "[", 
         RowBox[{"massWsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["n", "Higgs"], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massHiggssq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["n", "Singlet"], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massSinglet", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CWV", "[", 
       RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        SubscriptBox["n", "top"], "*", 
        RowBox[{"G", "[", 
         RowBox[{"masstsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Zboson"], "-", "2"}], ")"}], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massZsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Zboson"], "-", "1"}], ")"}], "*", 
        RowBox[{"Gtrans", "[", 
         RowBox[{"massZsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Wboson"], "-", "4"}], ")"}], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massWsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "Wboson"], "-", "2"}], ")"}], "*", 
        RowBox[{"Gtrans", "[", 
         RowBox[{"massWsq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["n", "Higgs"], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massHiggssq", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["n", "Singlet"], "*", 
        RowBox[{"G", "[", 
         RowBox[{"massSinglet", "[", 
          RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}]}]}]}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CWpotential", "[", 
   RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"CWV", "[", 
     RowBox[{"T", ",", "h", ",", "s"}], "]"}], "//", 
    RowBox[{
     RowBox[{"Rationalize", "[", 
      RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CWVwithGB", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CWV", "[", 
     RowBox[{"T", ",", "h", ",", "s"}], "]"}], "+", 
    RowBox[{
     SubscriptBox["n", "Chiboson"], "*", 
     RowBox[{"G", "[", 
      RowBox[{"mass\[Phi]sq", "[", 
       RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CWVpotentialwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CWVwithGB", "[", 
       RowBox[{"T", ",", "h", ",", "s"}], "]"}], "//", 
      RowBox[{
       RowBox[{"Rationalize", "[", 
        RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8006103683468313`*^9, 3.8006104171236215`*^9}, {
   3.8006130901485095`*^9, 3.800613105958414*^9}, {3.800613443079696*^9, 
   3.8006134437537346`*^9}, {3.800613517938978*^9, 3.8006135187580247`*^9}, {
   3.800616192408949*^9, 3.800616196186165*^9}, 3.8012068249007854`*^9, {
   3.801207233642164*^9, 3.8012074456332893`*^9}, {3.8012074909348803`*^9, 
   3.8012075196125207`*^9}, {3.8014789477067337`*^9, 
   3.8014789503868866`*^9}, {3.801479367234729*^9, 3.8014793694828577`*^9}, {
   3.801481904366845*^9, 3.801481982699325*^9}, {3.8014820138271055`*^9, 
   3.8014820583216505`*^9}, 3.8014821237153907`*^9, {3.8014822073421736`*^9, 
   3.8014822169427233`*^9}, {3.802452838202767*^9, 3.8024528425810175`*^9}, {
   3.8034059045455265`*^9, 3.8034059140670714`*^9}, {3.8040704364126205`*^9, 
   3.804070443470024*^9}, {3.804070560839737*^9, 3.8040705630708647`*^9}, {
   3.8040706168059387`*^9, 3.8040706403482847`*^9}, {3.8041784826659756`*^9, 
   3.8041784835300245`*^9}, {3.804243971754249*^9, 3.804244078719367*^9}, {
   3.8042441095061283`*^9, 3.80424411164025*^9}, {3.804244153572649*^9, 
   3.8042442108319235`*^9}, {3.8042442992849827`*^9, 3.804244435551777*^9}, 
   3.8042495116731143`*^9, {3.804396202492118*^9, 3.80439621529185*^9}, 
   3.8044268442053533`*^9, 3.804426971025607*^9, {3.8088210687868357`*^9, 
   3.8088210906892743`*^9}, {3.8088211239797325`*^9, 3.808821169781413*^9}, 
   3.8088212340847263`*^9, {3.808821278498004*^9, 3.808821281508809*^9}, {
   3.808821323582083*^9, 3.8088213270608892`*^9}, {3.8099436268432293`*^9, 
   3.809943662403263*^9}, {3.8099438929114475`*^9, 3.809943958573203*^9}, {
   3.8099440600520077`*^9, 3.8099440861695013`*^9}, {3.809944326521249*^9, 
   3.809944366488535*^9}, {3.809944414340272*^9, 3.809944417782469*^9}, {
   3.809945116133412*^9, 3.8099451522424774`*^9}, {3.81012143149732*^9, 
   3.810121656969217*^9}, {3.810122233062167*^9, 3.8101222508761864`*^9}, {
   3.8101378963330555`*^9, 3.81013806950096*^9}, 3.810141610813511*^9, {
   3.8101452666216116`*^9, 3.8101453788070283`*^9}, {3.8101454435407305`*^9, 
   3.810145463386866*^9}, {3.810146468914379*^9, 3.8101465860290775`*^9}, {
   3.8101467817182703`*^9, 3.8101469125867558`*^9}, {3.8101472617757277`*^9, 
   3.8101472867981586`*^9}, {3.810147533193252*^9, 3.810147533748284*^9}, {
   3.810148594313945*^9, 3.8101486276158495`*^9}, {3.8102187652475157`*^9, 
   3.8102187935771656`*^9}, {3.810218827008024*^9, 3.8102188670064945`*^9}, {
   3.810267441988194*^9, 3.810267571858622*^9}, {3.810267604402484*^9, 
   3.810267831542475*^9}, {3.8102756860237255`*^9, 3.810275695416263*^9}, {
   3.81027638998699*^9, 3.81027651393808*^9}, {3.8102766285366344`*^9, 
   3.810276630876768*^9}, {3.8114385304369593`*^9, 3.81143853307611*^9}, {
   3.8117481055606365`*^9, 3.8117481058146505`*^9}, {3.8123610667276487`*^9, 
   3.812361067119649*^9}, {3.812361662935856*^9, 3.8123617558702197`*^9}, {
   3.8123617900352793`*^9, 3.8123618527538385`*^9}, {3.8123619565876207`*^9, 
   3.8123619694576435`*^9}, {3.812362394777993*^9, 3.8123623962755957`*^9}, {
   3.8123625942555437`*^9, 3.8123626627728643`*^9}, {3.8123647976271105`*^9, 
   3.812364801480317*^9}, {3.812450789929453*^9, 3.8124507997880154`*^9}, {
   3.815922828514943*^9, 3.8159228309420815`*^9}, 3.8159228683352203`*^9, 
   3.8211118350857153`*^9, {3.821111899583366*^9, 3.821111926475507*^9}, {
   3.821111971360125*^9, 3.821111981505229*^9}, {3.821113486671241*^9, 
   3.821113489193027*^9}, {3.821113531152583*^9, 3.821113559400838*^9}, {
   3.8211144132203007`*^9, 3.821114589339967*^9}, {3.821114680463871*^9, 
   3.8211146935011787`*^9}, {3.821115979563569*^9, 3.82111598020201*^9}, {
   3.825415637832858*^9, 3.825415675133416*^9}, {3.8265645511092663`*^9, 
   3.826564569127006*^9}},ExpressionUUID->"a9141198-4b1e-4f5d-85f1-\
c2c5d2b7bdbf"],

Cell["\<\
These are useful derivatives defined for the Coleman-Weinberg part of the \
potential WITHOUT the Goldstone contributions.\
\>", "Text",
 CellChangeTimes->{{3.812363093390917*^9, 
  3.8123631142949533`*^9}},ExpressionUUID->"e5e3f87f-190b-4b79-9535-\
ee70c1f014a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "These", " ", "are", " ", "useful", " ", "derivatives", " ", "defined", 
     " ", "for", " ", "the", " ", "Coleman"}], "-", 
    RowBox[{
    "Weinberg", " ", "part", " ", "of", " ", "the", " ", "potential", " ", 
     "WITHOUT", " ", "the", " ", "Goldstone", " ", 
     RowBox[{"contributions", "."}]}]}], " ", "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"HderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"CWV", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], ")"}], 
      "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    FractionBox[
     SubscriptBox["dV", "CW"], "dh"], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HHderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"CWV", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
         "b"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["d", "2"], 
      SubscriptBox["V", "CW"]}], 
     SuperscriptBox["dh", "2"]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"CWV", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], ")"}], 
      "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    FractionBox[
     SubscriptBox["dV", "CW"], "ds"], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"CWV", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], ",", 
         "c"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["d", "2"], 
      SubscriptBox["V", "CW"]}], 
     RowBox[{
      SuperscriptBox["d", "2"], "s"}]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HSderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"CWV", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
         "c"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["d", "2"], 
      SubscriptBox["V", "CW"]}], "dhds"], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSSderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"CWV", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], 
           ",", "c"}], "]"}], ",", "c"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HHHderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"CWV", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], 
           ",", "b"}], "]"}], ",", "b"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HHHHderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"deriv", "[", 
              RowBox[{
               RowBox[{"CWV", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], 
             ",", "b"}], "]"}], ",", "b"}], "]"}], ",", "b"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["d", "4"], 
      SubscriptBox["V", "CW"]}], 
     SuperscriptBox["dh", "4"]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSSSderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"deriv", "[", 
              RowBox[{
               RowBox[{"CWV", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], 
             ",", "c"}], "]"}], ",", "c"}], "]"}], ",", "c"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox["d", "4"], 
      SubscriptBox["V", "CW"]}], 
     RowBox[{
      SuperscriptBox["d", "4"], "s"}]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSHderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"CWV", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], 
           ",", "c"}], "]"}], ",", "c"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HHSSderivativeCWV", "[", 
      RowBox[{"T_", ",", "h1_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"deriv", "[", 
              RowBox[{
               RowBox[{"CWV", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], 
             ",", "b"}], "]"}], ",", "c"}], "]"}], ",", "c"}], "]"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[Rule]", "T"}], ",", 
        RowBox[{"b", "\[Rule]", "h1"}], ",", 
        RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8034064803754625`*^9, 3.8034065042598286`*^9}, {
   3.8034065360326457`*^9, 3.803406629695003*^9}, {3.803406679171833*^9, 
   3.8034067077624683`*^9}, {3.80417862051886*^9, 3.80417867051672*^9}, 
   3.80424533146002*^9, {3.804396278988493*^9, 3.80439628348075*^9}, {
   3.8043963229340067`*^9, 3.804396340498011*^9}, {3.808822019718706*^9, 
   3.808822031434327*^9}, {3.80901107914255*^9, 3.8090110903433695`*^9}, {
   3.809185773138954*^9, 3.809185793155099*^9}, 3.8091859200273557`*^9, {
   3.810032173420849*^9, 3.8100322569206247`*^9}, {3.810121881296047*^9, 
   3.8101219116527834`*^9}, {3.810122351870963*^9, 3.8101224213769383`*^9}, {
   3.8101454220295005`*^9, 3.810145430251971*^9}, {3.8101454725913925`*^9, 
   3.8101456704697104`*^9}, {3.810147498156248*^9, 3.8101475572726293`*^9}, {
   3.8102678756799994`*^9, 3.8102678774180994`*^9}, {3.810276646873683*^9, 
   3.8102767561629343`*^9}, {3.8115077869538765`*^9, 
   3.8115078343945904`*^9}, {3.8115078702696424`*^9, 
   3.8115078874286237`*^9}, {3.811522160301339*^9, 3.811522246741063*^9}, {
   3.812362892507717*^9, 3.8123630567152524`*^9}, 3.8123630876657066`*^9, {
   3.8135608001829023`*^9, 3.8135608359680567`*^9}, {3.813562768185425*^9, 
   3.8135628054495564`*^9}, {3.8135630846826563`*^9, 3.8135631059488726`*^9}, 
   3.813563210432849*^9, {3.8135637649713845`*^9, 3.81356377590901*^9}, {
   3.8211119972570753`*^9, 3.821111999699449*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"141058ea-aa1f-4cf1-a428-5602ec837f0e"],

Cell["\<\





These are useful derivatives defined for the Coleman-Weinberg part of the \
potential WITH the Goldstone contributions.\
\>", "Text",
 CellChangeTimes->{{3.8123631278981776`*^9, 3.81236313499619*^9}, {
  3.8123631740274587`*^9, 
  3.812363175930662*^9}},ExpressionUUID->"cc95eec7-2fbe-4ffd-9a34-\
afca59d524f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"CWVwithGB", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   FractionBox[
    SubscriptBox["dV", "CW"], "dh"], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HHderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"CWVwithGB", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
         "b"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox["d", "2"], 
     SubscriptBox["V", "CW"]}], 
    SuperscriptBox["dh", "2"]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"CWVwithGB", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   FractionBox[
    SubscriptBox["dV", "CW"], "ds"], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"CWVwithGB", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], ",", 
         "c"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox["d", "2"], 
     SubscriptBox["V", "CW"]}], 
    RowBox[{
     SuperscriptBox["d", "2"], "s"}]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HSderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"CWVwithGB", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
         "c"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox["d", "2"], 
     SubscriptBox["V", "CW"]}], "dhds"], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HHHHderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"deriv", "[", 
              RowBox[{
               RowBox[{"CWVwithGB", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], 
             ",", "b"}], "]"}], ",", "b"}], "]"}], ",", "b"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox["d", "4"], 
     SubscriptBox["V", "CW"]}], 
    SuperscriptBox["dh", "4"]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSSSderivativeCWVwithGB", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deriv", "[", 
        RowBox[{
         RowBox[{"deriv", "[", 
          RowBox[{
           RowBox[{"deriv", "[", 
            RowBox[{
             RowBox[{"deriv", "[", 
              RowBox[{
               RowBox[{"CWVwithGB", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], 
             ",", "c"}], "]"}], ",", "c"}], "]"}], ",", "c"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "T"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox["d", "4"], 
     SubscriptBox["V", "CW"]}], 
    RowBox[{
     SuperscriptBox["d", "4"], "s"}]], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8034064803754625`*^9, 3.8034065042598286`*^9}, {
   3.8034065360326457`*^9, 3.803406629695003*^9}, {3.803406679171833*^9, 
   3.8034067077624683`*^9}, {3.80417862051886*^9, 3.80417867051672*^9}, 
   3.80424533146002*^9, {3.804396278988493*^9, 3.80439628348075*^9}, {
   3.8043963229340067`*^9, 3.804396340498011*^9}, {3.808822019718706*^9, 
   3.808822031434327*^9}, {3.80901107914255*^9, 3.8090110903433695`*^9}, {
   3.809185773138954*^9, 3.809185793155099*^9}, 3.8091859200273557`*^9, {
   3.810032173420849*^9, 3.8100322569206247`*^9}, {3.810121881296047*^9, 
   3.8101219116527834`*^9}, {3.810122351870963*^9, 3.8101224213769383`*^9}, {
   3.8101454220295005`*^9, 3.810145430251971*^9}, {3.8101454725913925`*^9, 
   3.8101456704697104`*^9}, {3.810147498156248*^9, 3.8101475572726293`*^9}, {
   3.8102678756799994`*^9, 3.8102678774180994`*^9}, {3.810276646873683*^9, 
   3.8102767561629343`*^9}, {3.8115077869538765`*^9, 
   3.8115078343945904`*^9}, {3.8115078702696424`*^9, 
   3.8115078874286237`*^9}, {3.811522160301339*^9, 3.811522246741063*^9}, {
   3.812362892507717*^9, 3.8123630567152524`*^9}, 3.8123630876657066`*^9, {
   3.812363120316564*^9, 3.8123631210029655`*^9}, {3.821112050122575*^9, 
   3.821112161384726*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"0659f1f1-dae8-4180-ad29-744c9de3bda4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter-terms", "Section",
 CellChangeTimes->{
  3.8211159327953663`*^9},ExpressionUUID->"6b2ae15c-26c2-4d94-abda-\
6b7840fcbf4c"],

Cell["\<\
Unlike on the paper, we will try to impose explicit counter-terms in order to \
obtain the correct values for the parameters. In particular, we are \
interested in keeping the EW minimum as the real minimum of the 1-loop \
effective potential.\
\>", "Text",
 CellChangeTimes->{{3.810110705399428*^9, 
  3.8101107888572016`*^9}},ExpressionUUID->"fabb721b-9dd5-40b7-8739-\
7339ec2e85af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Counterterms", "[", 
      RowBox[{
      "h_", ",", "s_", ",", "delta\[Lambda]h_", ",", "delta\[Lambda]s_", ",", 
       "delta\[Omega]_", ",", "delta\[Alpha]_", ",", "delta\[Rho]_"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"delta\[Lambda]h", "+", "delta\[Omega]", "+", "delta\[Rho]"}],
         ")"}], "*", 
       SuperscriptBox["h", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"delta\[Omega]", "+", "delta\[Rho]", "+", "delta\[Lambda]s"}],
         ")"}], "*", 
       SuperscriptBox["s", "2"]}], "+", 
      RowBox[{"delta\[Rho]", "*", 
       SuperscriptBox["h", "2"], "*", "s"}], "+", 
      RowBox[{"delta\[Omega]", "*", 
       SuperscriptBox["h", "2"], "*", 
       SuperscriptBox["s", "2"]}], "+", 
      RowBox[{"delta\[Lambda]h", "*", 
       SuperscriptBox["h", "4"]}], "+", 
      RowBox[{"delta\[Lambda]s", "*", 
       SuperscriptBox["s", "4"]}], "-", 
      RowBox[{"delta\[Alpha]", "*", 
       SuperscriptBox["s", "3"]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Counterterms", "[", 
      RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "delta\[Lambda]h", "*", 
       SuperscriptBox["h", "4"]}], "+", 
      RowBox[{
       FractionBox["1", "2"], "*", "delta\[Omega]", "*", 
       SuperscriptBox["h", "2"], "*", 
       SuperscriptBox["s", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "2"], "*", "delta\[Rho]", "*", 
       SuperscriptBox["h", "2"], "*", "s"}], "+", 
      RowBox[{
       FractionBox["1", "4"], "*", "delta\[Lambda]s", "*", 
       SuperscriptBox["s", "4"]}], "-", 
      RowBox[{
       FractionBox["1", "3"], "*", "delta\[Alpha]", "*", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{
       FractionBox["1", "2"], "deltaMuHSq", "*", 
       SuperscriptBox["h", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "2"], "deltaMuSSq", "*", 
       SuperscriptBox["s", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"dParams", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"deltaMuHSq", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"deltaMuSSq", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"delta\[Lambda]h", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "3"}], "]"}], "]"}]}], ",", 
      RowBox[{"delta\[Lambda]s", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "4"}], "]"}], "]"}]}], ",", 
      RowBox[{"delta\[Alpha]", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "5"}], "]"}], "]"}]}], ",", 
      RowBox[{"delta\[Rho]", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "6"}], "]"}], "]"}]}], ",", 
      RowBox[{"delta\[Omega]", "\[Rule]", 
       RowBox[{"dplist", "[", 
        RowBox[{"[", 
         RowBox[{"linked`vdtdz", ",", "7"}], "]"}], "]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8100255822698565`*^9, 3.8100255900823035`*^9}, {
   3.810025718967675*^9, 3.8100258008593593`*^9}, {3.8100258313191013`*^9, 
   3.8100260508456573`*^9}, {3.8100320523009214`*^9, 
   3.8100320912371483`*^9}, {3.810032124446048*^9, 3.8100321384168468`*^9}, {
   3.81006608796865*^9, 3.810066105381646*^9}, 3.810110849079646*^9, 
   3.8101145232307954`*^9, {3.810276769342688*^9, 3.8102769860210814`*^9}, {
   3.8103067858335333`*^9, 3.8103067883366766`*^9}, {3.811495974812301*^9, 
   3.811496090688929*^9}, {3.8114964653761573`*^9, 3.8114965806317496`*^9}, {
   3.811507936273383*^9, 3.811507945769926*^9}, {3.8115086257086687`*^9, 
   3.811508826054115*^9}, {3.8115088843134127`*^9, 3.8115089236156607`*^9}, {
   3.811513304393506*^9, 3.8115133255947185`*^9}, {3.8115134765143504`*^9, 
   3.8115135982573137`*^9}, {3.811514077256711*^9, 3.811514082504011*^9}, {
   3.8115151456875973`*^9, 3.811515160100422*^9}, {3.8115235857824345`*^9, 
   3.811523648862043*^9}, {3.8116570899910927`*^9, 3.811657226822199*^9}, {
   3.812113875179287*^9, 3.8121138927632933`*^9}, {3.812114953047938*^9, 
   3.81211497476218*^9}, {3.8121192102284346`*^9, 3.812119349703412*^9}, {
   3.812119934956887*^9, 3.8121200223348846`*^9}, {3.8123634508142014`*^9, 
   3.8123635201045704`*^9}, {3.8123652209603043`*^9, 
   3.8123652285107174`*^9}, {3.8135077843905973`*^9, 3.813507787623782*^9}, {
   3.813507835797537*^9, 3.8135078919917517`*^9}, {3.813508357070749*^9, 
   3.813508371129553*^9}, {3.8135084690343513`*^9, 3.81350847251355*^9}, {
   3.8135086094287777`*^9, 3.8135086119779234`*^9}, {3.8135086625388155`*^9, 
   3.8135087371480827`*^9}, {3.813508853293726*^9, 3.813508872313814*^9}, {
   3.8135090327909927`*^9, 3.813509048565895*^9}, {3.8135092794828825`*^9, 
   3.813509283054087*^9}, {3.813509413914921*^9, 3.8135094168670893`*^9}, {
   3.813509640879406*^9, 3.8135096464594793`*^9}, {3.8135099078244953`*^9, 
   3.813509910687659*^9}, {3.813563051578763*^9, 3.813563062682398*^9}, {
   3.813565234297454*^9, 3.8135652347784815`*^9}, {3.813565462671934*^9, 
   3.8135654628439436`*^9}, {3.8135859438608236`*^9, 3.8135859827040453`*^9}, 
   3.8135860333979445`*^9, {3.813848667309205*^9, 3.8138487093216085`*^9}, 
   3.8139448254195766`*^9, {3.8159003307841463`*^9, 3.8159004085915966`*^9}, {
   3.815900466811927*^9, 3.815900568700754*^9}, 3.8211121786211233`*^9, {
   3.821114314240745*^9, 3.8211143578023653`*^9}, {3.8239658860254097`*^9, 
   3.823965908264011*^9}, {3.824386277584155*^9, 
   3.824386294668911*^9}},ExpressionUUID->"043147b7-2c35-483d-93b3-\
8a73f92aaded"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculation of the 1-loop thermal (non-0-temperature) corrections\
\>", "Section",
 CellChangeTimes->{
  3.8211141889920692`*^9},ExpressionUUID->"c8e6a5c8-992b-4488-8635-\
a3caa7f95240"],

Cell[TextData[{
 "In this section we calculate the full 1-loop thermal contributions to the \
effective potential. We include the photon (with 3 degrees of freedom): the \
x->0 limit of the full J-function J_b(x) as defined via the integral \
converges to",
 Cell[BoxData[
  RowBox[{"(", 
   FractionBox[
    RowBox[{"-", 
     SuperscriptBox["\[Pi]", "4"]}], "45"], ")"}]],
  InitializationCell->True,
  CellChangeTimes->{{3.803212416866764*^9, 3.8032124749160843`*^9}, {
    3.803212627909835*^9, 3.8032127031921406`*^9}, {3.8032127350959654`*^9, 
    3.8032128987343254`*^9}, 3.8032134300407143`*^9, {3.8032134672338414`*^9, 
    3.80321356161924*^9}, {3.803213622927747*^9, 3.803213822066137*^9}, {
    3.8032138545819964`*^9, 3.8032138757022047`*^9}, {3.803213944279127*^9, 
    3.8032140267348433`*^9}, {3.8032141823367434`*^9, 3.803214217086731*^9}, {
    3.80321424820551*^9, 3.8032142692197123`*^9}, 3.8032143554856462`*^9, {
    3.803229512694358*^9, 3.803229637315486*^9}, {3.8032305754781456`*^9, 
    3.8032306211257567`*^9}, {3.8033207218879366`*^9, 3.803320793651041*^9}, {
    3.8041787794179487`*^9, 3.804178789743539*^9}, 3.804246387025395*^9, {
    3.804246611211218*^9, 3.8042466644132605`*^9}, {3.8042467930746193`*^9, 
    3.8042468124767294`*^9}, {3.804272935708893*^9, 3.8042729592672405`*^9}, {
    3.804427442561577*^9, 3.804427448053891*^9}, {3.804427518327911*^9, 
    3.804427630398321*^9}, {3.8044276803921804`*^9, 3.8044277268618383`*^9}, {
    3.8091874418083963`*^9, 3.8091874427134485`*^9}, {3.810148185691573*^9, 
    3.8101481992343473`*^9}, {3.810148239435647*^9, 3.8101484398821115`*^9}, {
    3.810148473673044*^9, 3.8101485212457657`*^9}, {3.8101486708453217`*^9, 
    3.8101487359540462`*^9}, {3.8102216515731244`*^9, 3.810221657033134*^9}, {
    3.8102680642637863`*^9, 3.8102681331187243`*^9}, {3.8102682779930105`*^9, 
    3.810268283846346*^9}, {3.8102684379751616`*^9, 3.810268443633485*^9}, 
    3.810277599691181*^9, 3.8102777454245167`*^9, {3.8116937807600913`*^9, 
    3.811693806532565*^9}, {3.811748046968285*^9, 3.8117480483573647`*^9}},
  ExpressionUUID->"713becac-3c2d-4e16-891e-1043c6d2248e"],
 ". The inclusion of this constant offset contribution by the photon is done \
by hand. Since no field dependence is present in the photon term, the \
dynamics of the phase transition should remain unaffected by this addition. \
However, it should have an effect - even if only marginal - on the degeneracy \
condition defining the critical temperature and the corresponding vevs."
}], "Text",
 CellChangeTimes->{{3.811748065214329*^9, 3.811748092821908*^9}, {
  3.811748231839859*^9, 
  3.8117485116718645`*^9}},ExpressionUUID->"ee97f5bd-8a26-479e-8838-\
49bfc5eef9e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"JB", "[", 
    RowBox[{"y_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{"-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", " ", "/", 
         RowBox[{"l", "^", "2"}]}], "  ", 
        RowBox[{"(", "y", ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "y", "]"}], "l"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JF", "[", 
     RowBox[{"y_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Re", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "l"}], " ", "/", 
         RowBox[{"l", "^", "2"}]}], "  ", 
        RowBox[{"(", "y", ")"}], " ", 
        RowBox[{"BesselK", "[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "y", "]"}], "l"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bosonsquaredmasses", "=", 
    RowBox[{"{", 
     RowBox[{
     "sqmassZ", ",", "sqmassW", ",", "sqmassH", ",", "sqmassChi", ",", 
      "sqmassS"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"fermionsquaredmasses", "=", 
   RowBox[{"{", "sqmassT", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dofbosons", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["n", "Zboson"], ",", 
     SubscriptBox["n", "Wboson"], ",", 
     SubscriptBox["n", "Higgs"], ",", 
     SubscriptBox["n", "Chiboson"], ",", 
     SubscriptBox["n", "Singlet"], ",", 
     SubscriptBox["n", "Photon"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"doffermions", "=", 
    RowBox[{"{", 
     SubscriptBox["n", "top"], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"resummationFlag", "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Thermal1loopV", "[", 
       RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", "T", ")"}], "4"], 
        RowBox[{"2", "*", 
         SuperscriptBox["\[Pi]", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["n", "top"]}], "*", 
          RowBox[{"JF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"masstsq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Zboson"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"massZsq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Photon"], "*", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"-", 
             SuperscriptBox["\[Pi]", "4"]}], "45"], ")"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Wboson"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"massWsq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Chiboson"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"mass\[Phi]sq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Higgs"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["T", "2"]], 
             RowBox[{"massHiggssq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}]}], ",", "5"}], "]"}]}],
          "+", 
         RowBox[{
          SubscriptBox["n", "Singlet"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["T", "2"]], 
             RowBox[{"massSinglet", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}]}], ",", "5"}], 
           "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Thermal1loopV", "[", 
       RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", "T", ")"}], "4"], 
        RowBox[{"2", "*", 
         SuperscriptBox["\[Pi]", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["n", "top"]}], "*", 
          RowBox[{"JF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"masstsq", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Zboson"], "-", "1"}], ")"}], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"massZsq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Zboson"], "-", "2"}], ")"}], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"massZsq", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Photon"], "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"-", 
             SuperscriptBox["\[Pi]", "4"]}], "45"], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Photon"], "-", "2"}], ")"}], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"mass\[Gamma]sq", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Wboson"], "-", "2"}], ")"}], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"massWsq", "[", 
              RowBox[{"0", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Wboson"], "-", "4"}], ")"}], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"massWsq", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Chiboson"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"mass\[Phi]sq", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}], 
             SuperscriptBox["T", "2"]], ",", "5"}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Higgs"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["T", "2"]], 
             RowBox[{"massHiggssq", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}]}], ",", "5"}], "]"}]}],
          "+", 
         RowBox[{
          SubscriptBox["n", "Singlet"], "*", 
          RowBox[{"JB", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["T", "2"]], 
             RowBox[{"massSinglet", "[", 
              RowBox[{"T", ",", "h", ",", "s"}], "]"}]}], ",", "5"}], 
           "]"}]}]}], ")"}]}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thermal1looppotential", "[", 
   RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Thermal1loopV", "[", 
     RowBox[{"T", ",", "h", ",", "s"}], "]"}], "//", 
    RowBox[{
     RowBox[{"Rationalize", "[", 
      RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.803212416866764*^9, 3.8032124749160843`*^9}, {
   3.803212627909835*^9, 3.8032127031921406`*^9}, {3.8032127350959654`*^9, 
   3.8032128987343254`*^9}, 3.8032134300407143`*^9, {3.8032134672338414`*^9, 
   3.80321356161924*^9}, {3.803213622927747*^9, 3.803213822066137*^9}, {
   3.8032138545819964`*^9, 3.8032138757022047`*^9}, {3.803213944279127*^9, 
   3.8032140267348433`*^9}, {3.8032141823367434`*^9, 3.803214217086731*^9}, {
   3.80321424820551*^9, 3.8032142692197123`*^9}, 3.8032143554856462`*^9, {
   3.803229512694358*^9, 3.803229637315486*^9}, {3.8032305754781456`*^9, 
   3.8032306211257567`*^9}, {3.8033207218879366`*^9, 3.803320793651041*^9}, {
   3.8041787794179487`*^9, 3.804178789743539*^9}, 3.804246387025395*^9, {
   3.804246611211218*^9, 3.8042466644132605`*^9}, {3.8042467930746193`*^9, 
   3.8042468124767294`*^9}, {3.804272935708893*^9, 3.8042729592672405`*^9}, {
   3.804427442561577*^9, 3.804427448053891*^9}, {3.804427518327911*^9, 
   3.804427630398321*^9}, {3.8044276803921804`*^9, 3.8044277268618383`*^9}, {
   3.8091874418083963`*^9, 3.8091874427134485`*^9}, {3.810148185691573*^9, 
   3.8101481992343473`*^9}, {3.810148239435647*^9, 3.8101484398821115`*^9}, {
   3.810148473673044*^9, 3.8101485212457657`*^9}, {3.8101486708453217`*^9, 
   3.8101487359540462`*^9}, {3.8102216515731244`*^9, 3.810221657033134*^9}, {
   3.8102680642637863`*^9, 3.8102681331187243`*^9}, {3.8102682779930105`*^9, 
   3.810268283846346*^9}, {3.8102684379751616`*^9, 3.810268443633485*^9}, 
   3.810277599691181*^9, 3.8102777454245167`*^9, {3.8116937807600913`*^9, 
   3.811693806532565*^9}, {3.811748046968285*^9, 3.8117480483573647`*^9}, {
   3.8123654596919937`*^9, 3.812365481750432*^9}, {3.812366484924596*^9, 
   3.8123664892822065`*^9}, 3.812366608586625*^9, {3.812366674675355*^9, 
   3.8123667047298098`*^9}, {3.8123719884323945`*^9, 3.81237200877264*^9}, {
   3.8123720790514193`*^9, 3.8123720854650345`*^9}, 3.8123721555023775`*^9, {
   3.8123722051744814`*^9, 3.8123723443334246`*^9}, {3.812372466359477*^9, 
   3.812372533339641*^9}, {3.8124697690555873`*^9, 3.8124697837839766`*^9}, {
   3.812469871725023*^9, 3.8124698798231535`*^9}, {3.8124699210254736`*^9, 
   3.8124699288996305`*^9}, {3.8124699984518695`*^9, 
   3.8124700294098673`*^9}, {3.8124701881716194`*^9, 3.812470207233735*^9}, 
   3.8159096259547997`*^9, {3.8159097423224554`*^9, 3.815909773281226*^9}, {
   3.8159098103733478`*^9, 3.815909823894121*^9}, {3.8159100300789146`*^9, 
   3.815910037537341*^9}, 3.8208433510521297`*^9, {3.821110027297079*^9, 
   3.8211100330659857`*^9}, {3.8211123277450438`*^9, 3.821112367311627*^9}, {
   3.821112404126425*^9, 3.821112453444606*^9}, {3.821113578643128*^9, 
   3.8211136696412077`*^9}, {3.821113783803479*^9, 3.821113886061658*^9}, {
   3.8211139437238407`*^9, 3.821114015431106*^9}, {3.821114145193594*^9, 
   3.82111414702078*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"76dd4960-70f1-4a03-8b8d-11cd02f91d03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation of the daisy/ring contributions", "Section",
 CellChangeTimes->{{3.821114167741829*^9, 3.821114175034198*^9}, {
  3.821115991632558*^9, 
  3.8211159931544037`*^9}},ExpressionUUID->"5c701a5b-4a83-499a-9cf9-\
1e4625df1276"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"thermalMassCorrections", "=", 
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"correctionZ", "=", 
        RowBox[{
         FractionBox["11", "6"], "*", 
         SuperscriptBox["g", "2"], "*", 
         SuperscriptBox["T", "2"], "*"}]}], ","}], "*)"}], 
     RowBox[{
      RowBox[{"correctionW", "=", 
       RowBox[{
        FractionBox["11", "6"], "*", 
        SuperscriptBox["g", "2"], "*", 
        SuperscriptBox["T", "2"]}]}], ",", 
      RowBox[{"correctionChi", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"3", "*", 
            SuperscriptBox["g", "2"]}], "16"], "+", 
          FractionBox[
           SuperscriptBox["gp", "2"], "16"], "+", 
          FractionBox["\[Lambda]", "2"], "+", 
          FractionBox[
           SuperscriptBox[
            SubscriptBox["y", "t"], "2"], "4"], "+", 
          FractionBox["\[Omega]", "6"]}], ")"}], "*", 
        SuperscriptBox["T", "2"]}]}], ",", 
      RowBox[{"correctionH", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"3", "*", 
            SuperscriptBox["g", "2"]}], "16"], "+", 
          FractionBox[
           SuperscriptBox["gp", "2"], "16"], "+", 
          FractionBox["\[Lambda]", "2"], "+", 
          FractionBox[
           SuperscriptBox[
            SubscriptBox["y", "t"], "2"], "4"], "+", 
          FractionBox["\[Omega]", "6"]}], ")"}], "*", 
        SuperscriptBox["T", "2"]}]}], ",", 
      RowBox[{"correctionS", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SubscriptBox["\[Lambda]", "S"], "4"], "+", 
          FractionBox["\[Omega]", "3"]}], ")"}], "*", 
        SuperscriptBox["T", "2"]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dof", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["n", "t"], "=", 
        RowBox[{"-", "12"}]}], ",", 
       RowBox[{
        SubscriptBox["n", "Z"], "=", "3"}], ",", 
       RowBox[{
        SubscriptBox["n", "W"], "=", "6"}], ",", 
       RowBox[{
        SubscriptBox["n", "Chi"], "=", "3"}], ",", 
       RowBox[{
        SubscriptBox["n", "h"], "=", "1"}], ",", 
       RowBox[{
        SubscriptBox["n", "s"], "=", "1"}]}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dofDaisies", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dof", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"dof", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "2"}], ",", 
      RowBox[{
       RowBox[{"dof", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", "4"}], ",", 
      RowBox[{"dof", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", 
      RowBox[{"dof", "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", 
      RowBox[{"dof", "[", 
       RowBox[{"[", "6", "]"}], "]"}], ",", 
      RowBox[{"dof", "[", 
       RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"dofDaisies", "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", "6"}], "]"}], "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"squaredmasses", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{"2", ",", "6"}], "]"}], "]"}], "]"}], "+", 
            "thermalMassCorrections"}], ")"}], 
          FractionBox["3", "2"]], "-", 
         SuperscriptBox[
          RowBox[{"squaredmasses", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", "6"}], "]"}], "]"}], "]"}], 
          FractionBox["3", "2"]]}], ")"}]}], "]"}], "]"}], ";"}], " ", "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"resummationFlag", "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Vdaisies", "[", 
       RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "T"}], 
        RowBox[{"12", "*", "\[Pi]"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Zboson"], "-", "2"}], ")"}], "*", 
          RowBox[{"Re", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massZsq", "[", 
               RowBox[{"T", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massZsq", "[", 
               RowBox[{"0", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["n", "Wboson"], "-", "4"}], ")"}], "*", 
          RowBox[{"Re", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massWsq", "[", 
               RowBox[{"T", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massWsq", "[", 
               RowBox[{"0", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]]}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Chiboson"], "*", 
          RowBox[{"Re", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"mass\[Phi]sq", "[", 
               RowBox[{"T", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"mass\[Phi]sq", "[", 
               RowBox[{"0", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]]}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Higgs"], "*", 
          RowBox[{"Re", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massHiggssq", "[", 
               RowBox[{"T", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massHiggssq", "[", 
               RowBox[{"0", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]]}], "]"}]}], "+", 
         RowBox[{
          SubscriptBox["n", "Singlet"], "*", 
          RowBox[{"Re", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massSinglet", "[", 
               RowBox[{"T", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"massSinglet", "[", 
               RowBox[{"0", ",", "h", ",", "s"}], "]"}], ")"}], 
             FractionBox["3", "2"]]}], "]"}]}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Vdaisies", "[", 
       RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", "0"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Daisypotential", "[", 
   RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Vdaisies", "[", 
      RowBox[{"T", ",", "h", ",", "s"}], "]"}], "//", 
     RowBox[{
      RowBox[{"Rationalize", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "//", "Simplify"}], 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8032170434563894`*^9, 3.8032170967264366`*^9}, {
   3.803217155974825*^9, 3.803217181516286*^9}, {3.8032172436398396`*^9, 
   3.803217266935172*^9}, {3.803217298249963*^9, 3.8032173391993055`*^9}, {
   3.8032174715958776`*^9, 3.8032174897609167`*^9}, 3.803218059687515*^9, {
   3.803230897800582*^9, 3.803230941944106*^9}, {3.8041789233261795`*^9, 
   3.8041789304795885`*^9}, {3.804263442006884*^9, 3.8042634981020927`*^9}, {
   3.8043244143937783`*^9, 3.804324419038044*^9}, {3.804324449533788*^9, 
   3.8043244519999294`*^9}, {3.804324731786932*^9, 3.8043247647348166`*^9}, 
   3.8043248152057037`*^9, {3.8090172979888134`*^9, 3.809017304813204*^9}, 
   3.8091875897158566`*^9, {3.809187673841668*^9, 3.809187677279865*^9}, {
   3.8099442743072624`*^9, 3.8099443031539125`*^9}, {3.809944851994304*^9, 
   3.809944885815239*^9}, {3.809944918565112*^9, 3.809944976119404*^9}, {
   3.8099452691781654`*^9, 3.809945291181424*^9}, 3.8099453746712*^9, {
   3.810148912100121*^9, 3.810148932920312*^9}, {3.810148979249962*^9, 
   3.810149187539875*^9}, {3.8102685494255357`*^9, 3.810268610738043*^9}, {
   3.8102773565402737`*^9, 3.8102774738969865`*^9}, {3.81027750438673*^9, 
   3.8102775615550003`*^9}, {3.8102776147670436`*^9, 
   3.8102777147497625`*^9}, {3.8114383449534492`*^9, 
   3.8114384113012447`*^9}, {3.8114386054072475`*^9, 
   3.8114386139877377`*^9}, {3.8114386690998554`*^9, 
   3.8114387170415974`*^9}, {3.8114391400631895`*^9, 
   3.8114393112448463`*^9}, {3.811439351985176*^9, 3.811439356352426*^9}, 
   3.811439573895179*^9, {3.811439647887531*^9, 3.8114396741110306`*^9}, {
   3.8116040726631155`*^9, 3.8116040882603455`*^9}, {3.811604219561612*^9, 
   3.811604226223626*^9}, 3.811604317528802*^9, 3.8116043677078953`*^9, {
   3.8116048883125315`*^9, 3.8116049358176236`*^9}, {3.8121125697896233`*^9, 
   3.812112570508664*^9}, {3.8121126328202286`*^9, 3.8121126573406305`*^9}, {
   3.8121126963988647`*^9, 3.812112700352091*^9}, {3.8121127440835924`*^9, 
   3.8121127492668886`*^9}, {3.812131387050909*^9, 3.812131399854641*^9}, 
   3.8123679088634543`*^9, {3.812367952453931*^9, 3.812367956684539*^9}, {
   3.815906827878759*^9, 3.8159068572424383`*^9}, {3.8159074829712276`*^9, 
   3.8159075054445133`*^9}, 3.8159075387184167`*^9, {3.8159079501889515`*^9, 
   3.8159079708891354`*^9}, {3.815908145960149*^9, 3.815908150293397*^9}, {
   3.8211124882634153`*^9, 3.821112635913206*^9}, {3.821112913463798*^9, 
   3.821112932416584*^9}, {3.821113705405923*^9, 3.8211137427953672`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"3b1bd3d2-1391-471a-9fd8-3033270b50a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization of the full effective potential", "Section",
 CellChangeTimes->{{3.821116007140111*^9, 
  3.821116016938828*^9}},ExpressionUUID->"bce91565-ff84-47b6-9f15-\
65bc9f89bc4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"potential0T", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"treepotential", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], "+", 
      RowBox[{"CWVpotentialwithGB", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], "+", 
      RowBox[{"Counterterms", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "0"}], ",", 
      RowBox[{"b", "\[Rule]", "h"}], ",", 
      RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Hderivativepotential0T", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"deriv", "[", 
     RowBox[{
      RowBox[{"potential0T", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "0"}], ",", 
      RowBox[{"b", "\[Rule]", "h"}], ",", 
      RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sderivativepotential0T", "[", 
     RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{
       RowBox[{"potential0T", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", "0"}], ",", 
       RowBox[{"b", "\[Rule]", "h"}], ",", 
       RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "T", " ", "is", " ", "included", " ", "as", " ", "a", " ", "parameter", 
    " ", "but", " ", "really", " ", "does", " ", "not", " ", "do", " ", 
    RowBox[{"anything", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"treepotential", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], "+", 
      RowBox[{"CWVpotentialwithGB", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], "+", 
      RowBox[{"Counterterms", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], "+", 
      RowBox[{"Thermal1looppotential", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], "+", 
      RowBox[{"Vdaisies", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "T"}], ",", 
      RowBox[{"b", "\[Rule]", "h"}], ",", 
      RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Hderivativepotential", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"deriv", "[", 
     RowBox[{
      RowBox[{"potential", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "T"}], ",", 
      RowBox[{"b", "\[Rule]", "h"}], ",", 
      RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sderivativepotential", "[", 
    RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"deriv", "[", 
     RowBox[{
      RowBox[{"potential", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "T"}], ",", 
      RowBox[{"b", "\[Rule]", "h"}], ",", 
      RowBox[{"c", "\[Rule]", "s"}]}], "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8041752563754425`*^9, 3.804175299557912*^9}, {
   3.8041753505858307`*^9, 3.8041754334535704`*^9}, 3.8041793552428837`*^9, 
   3.8091877946805797`*^9, {3.81003190401544*^9, 3.810031999184883*^9}, {
   3.8100505793706093`*^9, 3.8100505886761413`*^9}, {3.8101127188405905`*^9, 
   3.810112734193468*^9}, {3.810112769452485*^9, 3.8101128024693737`*^9}, {
   3.810112968743884*^9, 3.8101131626749763`*^9}, {3.8101132910623198`*^9, 
   3.810113293831478*^9}, {3.810149234337552*^9, 3.8101494476567535`*^9}, {
   3.810149491024234*^9, 3.8101495154986334`*^9}, {3.8102085090226393`*^9, 
   3.8102085119866447`*^9}, {3.8102130568311615`*^9, 3.810213060529373*^9}, {
   3.81021500271846*^9, 3.8102150095028477`*^9}, {3.8102188941973424`*^9, 
   3.8102189005777535`*^9}, {3.8102220891073165`*^9, 3.810222093157548*^9}, {
   3.8102687482529078`*^9, 3.8102687495319815`*^9}, {3.810277816536584*^9, 
   3.810277822671935*^9}, {3.810301041938001*^9, 3.810301053588668*^9}, {
   3.810307098887439*^9, 3.8103071023606377`*^9}, {3.810320061326848*^9, 
   3.810320090874538*^9}, {3.8115111435427227`*^9, 3.811511240476267*^9}, {
   3.8116683157895174`*^9, 3.8116683450603714`*^9}, {3.811668580359074*^9, 
   3.811668583128279*^9}, {3.81166867020308*^9, 3.8116686729666862`*^9}, {
   3.812368020748127*^9, 3.8123681061095114`*^9}, {3.812368349145719*^9, 
   3.812368357325983*^9}, {3.812368490273987*^9, 3.812368515038244*^9}, {
   3.812368718798976*^9, 3.8123687350256166`*^9}, {3.812368840003827*^9, 
   3.8123688431298323`*^9}, 3.8123692215394926`*^9, {3.8123692737332144`*^9, 
   3.812369296955496*^9}, {3.812369360851441*^9, 3.8123694047233777`*^9}, {
   3.812449149146886*^9, 3.812449161805609*^9}, {3.812531065170206*^9, 
   3.812531070312417*^9}, {3.821113211593425*^9, 3.82111324684335*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"b1f843fd-c530-43f6-ac4b-0da2b55eb32b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.81584629313594*^9, 3.8158463034605308`*^9}, {
   3.8158984236000614`*^9, 3.8158984654244537`*^9}, {3.8159089956317472`*^9, 
   3.8159090703450203`*^9}, {3.8159091884797773`*^9, 3.815909195568183*^9}, {
   3.815909999359157*^9, 3.8159100231395173`*^9}, {3.81824736079825*^9, 
   3.818247365357031*^9}, 
   3.820843398623152*^9},ExpressionUUID->"1e9413e1-18cc-44ea-9cf8-\
a181eb0c8984"],

Cell[BoxData[{
 RowBox[{"singletmass", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"(*", "sqmassS", "*)"}], 
     RowBox[{"massSinglet", "[", 
      RowBox[{"0", ",", "h", ",", "s"}], "]"}], "]"}], "/.", "Params"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"h", "\[Rule]", "v"}], ",", 
     RowBox[{"s", "\[Rule]", "x"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Iteration \>\"", ",", "linked`vdtdz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<MuHSq is \>\"", ",", "muH"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<MuSSq is \>\"", ",", "muS"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Singlet vev is \>\"", ",", "singletvev"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Singlet mass is \>\"", ",", "singletmass"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Nucleation temperature is \>\"", ",", 
     RowBox[{"tnuclist", "[", 
      RowBox[{"[", "linked`vdtdz", "]"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<**********\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<**********\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.815846346263979*^9, 3.815846355661516*^9}, {
   3.8158984403440194`*^9, 3.815898468998658*^9}, {3.8158985781699023`*^9, 
   3.815898578732935*^9}, {3.8158986646648498`*^9, 3.8158987009719267`*^9}, {
   3.8158998109484134`*^9, 3.8158998212300014`*^9}, {3.815899991426736*^9, 
   3.815900002298358*^9}, {3.815909110090294*^9, 3.815909141109068*^9}, {
   3.815920789475316*^9, 3.815920798159813*^9}, {3.818247373298026*^9, 
   3.81824737733827*^9}, {3.819012313907319*^9, 3.819012326903885*^9}, {
   3.819012426646192*^9, 3.819012453512579*^9}, {3.819012484897106*^9, 
   3.819012490538227*^9}, {3.819012555883264*^9, 3.819012571393126*^9}, {
   3.8201564219812937`*^9, 3.820156442675475*^9}, 3.820843393113022*^9, {
   3.8233541232267017`*^9, 3.823354135851376*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"30d3021e-e02b-47ff-87d8-2096f7335fa7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relaxation method for the singlet model", "Subtitle",
 CellChangeTimes->{{3.411809262809*^9, 3.4118092680038*^9}, {
  3.805030076512436*^9, 
  3.805030079439604*^9}},ExpressionUUID->"3bee6173-2860-41a4-97aa-\
16b4c2f03c3f"],

Cell[CellGroupData[{

Cell["Description", "Section",
 CellChangeTimes->{{3.411809277317*^9, 
  3.4118092776134*^9}},ExpressionUUID->"ac4693d7-05b3-40d8-8440-ef2c344f4754"],

Cell["\<\
This is a general-purpose notebook featuring an algorithm able to solve \
coupled, second-order, strongly non-linear differential equations with either \
Dirichlet, Neumann or mixed conditions***. The implementation below is set to \
compute the solutions to the bounce equations for the singlet model discussed \
by A. Ahriche in  his paper \[OpenCurlyDoubleQuote]What is the criterion for \
a strong first order electroweak phase transition in singlet models?\
\[CloseCurlyDoubleQuote] (2007). The tree-level potential and all relevant \
corrections up to first order in perturbation theory, as well as their \
derivatives, are defined on separate notebooks which should ideally be \
executed in order before this one.

This code presents two different parametrizations of the independent \
variable. In order to use one, please un-comment the other.  The linear \
parametrization is set by default.

This work was created off an instance of the code by Manuel Bichsel (ETH \
Zurich) and consequently corrected, completed, upgraded and further adapted \
to its current use by \[CapitalAAcute]lvaro Lozano Onrubia (Max Planck \
Institute for Nuclear Physics, Heidelberg).


*** Currently, the code below operates with Neumann-type conditions. In order \
to switch the type of boundary condition, the user needs to adapt the code \
himself. Only minor changes are necessary; an outline of the algorithm can be \
found in chapter 16 of the book \[OpenCurlyDoubleQuote]Numerical Recipes\
\[CloseCurlyDoubleQuote] by Press, Flannery, Teukolsky & Vetterlin.

ATTENTION: CURRENTLY RUNNING WITH NUMERICAL METHODS AT LINEAR SOLVE - faster \
but could lead to numerical errors.\
\>", "Text",
 CellChangeTimes->{{3.39239384059375*^9, 3.392393840625*^9}, {
   3.411809272949*^9, 3.411809273495*^9}, {3.8050291290692453`*^9, 
   3.805030043146528*^9}, {3.805030113787568*^9, 3.8050301142805967`*^9}, {
   3.805031652483577*^9, 3.805031653281622*^9}, 3.8054279625645514`*^9, {
   3.810542001825646*^9, 
   3.8105420394908004`*^9}},ExpressionUUID->"5a432066-e762-46d7-b5d4-\
6a44ce9896a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Input", "Section",ExpressionUUID->"c70b6804-918b-49f0-a4ee-a4975d0e03ef"],

Cell[CellGroupData[{

Cell["\<\
Definition of an appropriate derivative operator for the code\
\>", "Subsubsection",
 CellChangeTimes->{
  3.8044284331502357`*^9},ExpressionUUID->"523c364f-a165-4891-9ced-\
cdecc616254e"],

Cell["\<\
In this notebook, I define a derivative operator that can take care of \
derivatives with respect to terms enclosed in the Re[...] and Im[...] \
operators picking the real and imaginary parts of expressions.\
\>", "Text",
 CellChangeTimes->{{3.8044283964461365`*^9, 3.804428416732297*^9}, {
  3.805030310056794*^9, 
  3.8050303566504593`*^9}},ExpressionUUID->"e54cb85c-19f3-4626-ade0-\
d72355bd7bc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deriv", "[", 
   RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"expr", ",", "var"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Re", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"D", "[", 
         RowBox[{"e", ",", "var"}], "]"}], "]"}], "/", 
       RowBox[{"D", "[", 
        RowBox[{"e", ",", "var"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Im", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"D", "[", 
         RowBox[{"e", ",", "var"}], "]"}], "]"}], "/", 
       RowBox[{"D", "[", 
        RowBox[{"e", ",", "var"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Arg", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"e", ",", "var"}], "]"}], "/", "e"}], "]"}], "/", 
       RowBox[{"D", "[", 
        RowBox[{"e", ",", "var"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "'"}], "[", "e_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "e", "]"}], " ", 
          RowBox[{"Re", "[", 
           RowBox[{"D", "[", 
            RowBox[{"e", ",", "var"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Im", "[", "e", "]"}], " ", 
          RowBox[{"Im", "[", 
           RowBox[{"D", "[", 
            RowBox[{"e", ",", "var"}], "]"}], "]"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", "e", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{"e", ",", "var"}], "]"}]}], ")"}]}]}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.804428403689551*^9, 3.8044284037185526`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"2cc19a80-c21f-478c-8c03-905373cf57a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["model settings", "Subsection",ExpressionUUID->"8c6e244c-da93-4b3c-9768-1f25e23528ae"],

Cell[BoxData[GridBox[{
   {
    RowBox[{
     RowBox[{"(*", " ", "Preparations", " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{
         RowBox[{"General", "::", "spell"}], ",", 
         RowBox[{"General", "::", "spell1"}]}], "]"}], ";"}], "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"declaration", " ", "of", " ", "the", " ", "variables"}], ",",
         " ", 
        RowBox[{"the", " ", "ODEs"}], ",", " ", 
        RowBox[{
        "and", " ", "the", " ", "number", " ", "of", " ", "initial", " ", 
         "and", " ", "final", " ", "boundary", " ", "conditions"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "introduction", " ", "of", " ", "the", " ", "variable", " ", "names", 
         " ", "in", " ", "the", " ", "same", " ", "order", " ", "as", " ", 
         "in", " ", "the", " ", "ODE", " ", "equations", " ", "below"}], ",", 
        " ", 
        RowBox[{"but", " ", "begin", " ", "with", " ", "time", " ", "t"}]}], 
       " ", "*)"}], "\n", 
      RowBox[{
       RowBox[{"variableNames", " ", "=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<t\>\"", ",", "\[IndentingNewLine]", "\"\<f\>\"", ",", 
          "\[IndentingNewLine]", "\"\<h\>\"", ",", "\[IndentingNewLine]", 
          "\"\<p\>\"", ",", "\[IndentingNewLine]", "\"\<a\>\"", ",", 
          "\[IndentingNewLine]", "\"\<b\>\"", ",", "\[IndentingNewLine]", 
          "\"\<c\>\""}], "\[IndentingNewLine]", "}"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Definition", " ", "of", " ", "model", " ", "parameters"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Model", " ", "parameters", " ", "should", " ", "ideally", " ", "be", 
         " ", "defined", " ", "here"}], ",", " ", 
        RowBox[{
        "before", " ", "the", " ", "actual", " ", "equations", " ", "to", " ",
          "be", " ", 
         RowBox[{"solved", ".", " ", "For"}], " ", "users", " ", "of", " ", 
         "the", " ", "notebooks", "\[IndentingNewLine]", "calculating", " ", 
         "the", " ", "effective", " ", 
         RowBox[{"potential", ":", " ", 
          RowBox[{
           RowBox[{
           "this", " ", "is", " ", "the", " ", "spot", " ", "to", " ", 
            "copy"}], "-", 
           RowBox[{
           "paste", " ", "the", " ", "results", " ", "obtained", " ", "for", 
            " ", "muHSq", " ", "and", " ", "muSSq", " ", "after", " ", 
            "executing", "\[IndentingNewLine]", "the", " ", "whole", " ", 
            "of", " ", "the", " ", "first", " ", 
            RowBox[{"notebook", "."}]}]}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Values", " ", "in", " ", "brackets", " ", "correspond", " ", "to", 
        " ", "the", " ", "critical", " ", "values"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hderpot0", "[", 
         RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Hderivativepotential0T", "[", 
           RowBox[{"T", ",", "h", ",", "s"}], "]"}], "/.", "Params"}], "/.", 
         "dParams"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sderpot0", "[", 
         RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Sderivativepotential0T", "[", 
           RowBox[{"T", ",", "h", ",", "s"}], "]"}], "/.", "Params"}], "/.", 
         "dParams"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hderpot", "[", 
         RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Hderivativepotential", "[", 
           RowBox[{"T", ",", "h", ",", "s"}], "]"}], "/.", "Params"}], "/.", 
         "dParams"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sderpot", "[", 
         RowBox[{"T_", ",", "h_", ",", "s_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Sderivativepotential", "[", 
           RowBox[{"T", ",", "h", ",", "s"}], "]"}], "/.", "Params"}], "/.", 
         "dParams"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "=", "CouplingG"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "t"], "=", "TopYukawa"}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gprime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Q", "=", "ScaleQ"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"finiteTv", "=", 
        RowBox[{"(*", "202.90830406", "*)"}], 
        RowBox[{"nucvevs", "[", 
         RowBox[{"[", 
          RowBox[{"linked`vdtdz", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
      RowBox[{
       RowBox[{"finiteTx", "=", 
        RowBox[{"(*", "230.27641849", "*)"}], 
        RowBox[{"nucvevs", "[", 
         RowBox[{"[", 
          RowBox[{"linked`vdtdz", ",", "2"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=", 
        RowBox[{"(*", "116.49", "*)"}], 
        RowBox[{"tnuclist", "[", 
         RowBox[{"[", "linked`vdtdz", "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"finiteT\[CapitalOmega]", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["finiteTv", "2"], "+", 
          SuperscriptBox["finiteTx", "2"]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"muHSquare", "=", "muH"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"muSSquare", "=", "muS"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"fODE", "[", 
         RowBox[{
         "f_", ",", "l_", ",", "r_", ",", "a_", ",", "b_", ",", "c_"}], "]"}],
         " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "a", ",", "\[IndentingNewLine]", "b", ",", "\[IndentingNewLine]", 
          "c", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            FractionBox["2", 
             SuperscriptBox["time", "2"]], "f", 
            RowBox[{"(", 
             RowBox[{"1", "-", "f"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", "f"}]}], ")"}]}], "-", 
           RowBox[{
            FractionBox[
             SuperscriptBox["finiteTv", "2"], 
             RowBox[{"4", "*", 
              SuperscriptBox[
               RowBox[{"(", "finiteT\[CapitalOmega]", ")"}], "2"]}]], 
            SuperscriptBox["l", "2"], 
            RowBox[{"(", 
             RowBox[{"1", "-", "f"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            FractionBox["2", 
             SuperscriptBox["time", "2"]], "l", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "f"}], ")"}], "2"]}], "-", 
           RowBox[{
            FractionBox["2", "time"], "*", "b"}], "+", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              SuperscriptBox["g", "2"], "*", 
              RowBox[{"(", "finiteTv", ")"}], "*", 
              SuperscriptBox[
               RowBox[{"(", "finiteT\[CapitalOmega]", ")"}], "2"]}]], "*", 
            RowBox[{"Hderpot", "[", 
             RowBox[{"temp", ",", 
              RowBox[{
               RowBox[{"finiteTv", "*", "l"}], "+", "0.01"}], ",", 
              RowBox[{
               RowBox[{"finiteTx", "*", "r"}], "+", "0.01"}]}], "]"}]}]}], 
          ",", 
          RowBox[{"(*", 
           RowBox[{
           "changed", " ", "the", " ", "exponent", " ", "of", " ", 
            "finiteTv"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"-", "2"}], "time"], "*", "c"}], "+", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              SuperscriptBox["g", "2"], "*", 
              RowBox[{"(", "finiteTx", ")"}], "*", 
              SuperscriptBox[
               RowBox[{"(", "finiteT\[CapitalOmega]", ")"}], "2"]}]], "*", 
            RowBox[{"Sderpot", "[", 
             RowBox[{"temp", ",", 
              RowBox[{
               RowBox[{"finiteTv", "*", "l"}], "+", "0.01"}], ",", 
              RowBox[{
               RowBox[{"finiteTx", "*", "r"}], "+", "0.01"}]}], "]"}]}]}]}], 
         RowBox[{"(*", 
          RowBox[{
          "changed", " ", "the", " ", "exponent", " ", "of", " ", 
           "finiteTx"}], "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "conditions", " ", "and", " ", "equations"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nInitial", " ", "=", " ", "3"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "number", " ", "of", " ", "initial", " ", "boundary", " ", 
         "conditions"}], " ", "*)"}], "\n", 
       RowBox[{"nFinal", " ", "=", " ", "3"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "number", " ", "of", " ", "final", " ", "boundary", " ", 
         "conditions"}], " ", "*)"}], "\n", 
       RowBox[{"nStatic", " ", "=", " ", "0"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"number", " ", "of", " ", "static", " ", "equations"}], " ", 
        "*)"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "computation", " ", "of", " ", "the", " ", "inital", " ", "and", " ", 
         "final", " ", "steady", " ", "states", " ", "of", " ", "k", " ", 
         "and", " ", "c"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"kss", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"delta", "+", "rho", "+", 
               RowBox[{"gx", "*", "theta"}]}], ")"}], " ", "/", " ", 
             "alpha"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"alpha", "-", "1"}], ")"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"css", " ", "=", " ", 
          RowBox[{
           RowBox[{"kss", "^", "alpha"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nPop", "+", "delta", "+", "gx"}], ")"}], "*", 
            "kss"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"initialValues", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.1", "*", "kss"}], ",", "css"}], "}"}]}], ";", "\n", 
         RowBox[{"finalValues", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"kss", ",", "css"}], "}"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"initialValues", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";"}], " ", "\n", 
      RowBox[{
       RowBox[{"finalValues", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";"}], "\[IndentingNewLine]"}]}]},
   {"\[Placeholder]"}
  }]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.791087000334608*^9, 3.7910870237199097`*^9}, {
   3.791087107373217*^9, 3.791087136402913*^9}, {3.7910872397353373`*^9, 
   3.7910872404528027`*^9}, {3.791088399891667*^9, 3.791088469857958*^9}, {
   3.7910889674440193`*^9, 3.791089028967121*^9}, {3.7939052989557104`*^9, 
   3.7939053081382356`*^9}, {3.793905402331623*^9, 3.7939054101330695`*^9}, {
   3.7939093979790883`*^9, 3.793909604470899*^9}, {3.7939097911365757`*^9, 
   3.7939098033382735`*^9}, {3.7939100259240046`*^9, 
   3.7939100283151417`*^9}, {3.79391023126575*^9, 3.7939102364920483`*^9}, {
   3.793910715762461*^9, 3.7939107500144205`*^9}, {3.7939142580720696`*^9, 
   3.793914293798113*^9}, {3.793914522762209*^9, 3.7939145373720446`*^9}, {
   3.79451544792687*^9, 3.7945154729283*^9}, {3.7945155637124925`*^9, 
   3.794515568429762*^9}, {3.7945167656792407`*^9, 3.794516775011775*^9}, {
   3.7945168343931713`*^9, 3.794516864687904*^9}, {3.794516960364376*^9, 
   3.79451697599627*^9}, {3.7945699295731945`*^9, 3.7945699566507435`*^9}, {
   3.794571079330957*^9, 3.794571082072114*^9}, {3.794571117920164*^9, 
   3.794571149510971*^9}, {3.79457132153481*^9, 3.7945713261540747`*^9}, {
   3.794571593018338*^9, 3.794571608163204*^9}, {3.794574973451688*^9, 
   3.794575001443289*^9}, {3.794575450235958*^9, 3.794575491477317*^9}, {
   3.794575596180306*^9, 3.794575596544327*^9}, {3.7945757288498945`*^9, 
   3.7945757891043406`*^9}, {3.794575950484571*^9, 3.7945759654084244`*^9}, {
   3.7945761265286403`*^9, 3.7945761365732145`*^9}, {3.7945764224745674`*^9, 
   3.794576474591548*^9}, {3.7945766685906444`*^9, 3.7945766711437902`*^9}, {
   3.794577043831107*^9, 3.7945770499974594`*^9}, {3.794595084312253*^9, 
   3.7945950844772625`*^9}, {3.795931411082726*^9, 3.795931463985752*^9}, {
   3.7959523211021514`*^9, 3.795952408882172*^9}, 3.7959524429851227`*^9, {
   3.795952475841002*^9, 3.7959525152382555`*^9}, {3.795952643035565*^9, 
   3.7959526431065693`*^9}, {3.7959528378927097`*^9, 3.795952897929144*^9}, {
   3.7960158263658247`*^9, 3.7960158276258965`*^9}, {3.796645724822955*^9, 
   3.79664596531371*^9}, {3.79664619626892*^9, 3.796646196756948*^9}, {
   3.796647772386069*^9, 3.796647773718145*^9}, {3.798170295488895*^9, 
   3.798170539712864*^9}, {3.7981705714386787`*^9, 3.798170631459111*^9}, {
   3.7981706719234257`*^9, 3.798170702655184*^9}, 3.7981709257589445`*^9, {
   3.7981710280747967`*^9, 3.798171043785695*^9}, {3.798182882934225*^9, 
   3.7981828987471294`*^9}, {3.7981829401084957`*^9, 3.798183030215649*^9}, {
   3.798183112546358*^9, 3.79818314981649*^9}, {3.798183214122168*^9, 
   3.7981832143951836`*^9}, 3.798183300787125*^9, {3.7983150430300064`*^9, 
   3.7983151667800846`*^9}, {3.7996120223140235`*^9, 
   3.7996120704827785`*^9}, {3.7996125520724473`*^9, 3.799612552702483*^9}, 
   3.801228253015088*^9, {3.801327655957815*^9, 3.801327656830888*^9}, 
   3.801461810140417*^9, {3.8032053956171713`*^9, 3.803205473650635*^9}, {
   3.8032055142819586`*^9, 3.8032056161377845`*^9}, {3.803205648476634*^9, 
   3.803205663892516*^9}, {3.803205755739769*^9, 3.8032057894756985`*^9}, {
   3.803208135423879*^9, 3.803208167311703*^9}, {3.803208482066706*^9, 
   3.8032084953254642`*^9}, {3.803218114551653*^9, 3.803218165005539*^9}, {
   3.803218390249422*^9, 3.803218402718135*^9}, {3.803218994471981*^9, 
   3.803219012506013*^9}, {3.803219061341806*^9, 3.803219105657341*^9}, {
   3.803219170593055*^9, 3.8032191963525286`*^9}, {3.8032192448193007`*^9, 
   3.8032192545458565`*^9}, {3.8032192934210806`*^9, 3.803219303712669*^9}, {
   3.803231323253916*^9, 3.8032313480733356`*^9}, {3.8032318374593267`*^9, 
   3.8032318560503902`*^9}, {3.803231985383788*^9, 3.803232000820671*^9}, {
   3.803232039084859*^9, 3.803232050611519*^9}, {3.803232227972663*^9, 
   3.8032322296037564`*^9}, {3.803320023237976*^9, 3.8033200295963397`*^9}, {
   3.803383444276218*^9, 3.803383471992803*^9}, {3.8033857460338707`*^9, 
   3.80338576507796*^9}, {3.8033858115586185`*^9, 3.803385837093079*^9}, {
   3.8033893934656982`*^9, 3.803389423134395*^9}, {3.803389513969591*^9, 
   3.8033895180728254`*^9}, {3.8033898468676314`*^9, 
   3.8033898471296463`*^9}, {3.803453636164034*^9, 3.803453652943993*^9}, {
   3.803460115891653*^9, 3.803460159125126*^9}, {3.804179516126086*^9, 
   3.8041797672254477`*^9}, {3.8041863318529234`*^9, 
   3.8041863414164705`*^9}, {3.8041863930294223`*^9, 
   3.8041864532998695`*^9}, {3.804189265254491*^9, 3.8041893506743765`*^9}, {
   3.8041894500150585`*^9, 3.8041894648489075`*^9}, {3.804193274718819*^9, 
   3.8041932869485188`*^9}, {3.804197032606758*^9, 3.8041970647655973`*^9}, {
   3.804197974758646*^9, 3.804198007313508*^9}, {3.804198044682646*^9, 
   3.8041980477298203`*^9}, {3.804199316713402*^9, 3.8041993623930144`*^9}, {
   3.8042234318384457`*^9, 3.8042235370364623`*^9}, {3.804223818965588*^9, 
   3.8042238196766286`*^9}, {3.8042239670810595`*^9, 
   3.8042239818369036`*^9}, {3.804224814594535*^9, 3.804224815023559*^9}, {
   3.8042248607281733`*^9, 3.804224891543936*^9}, {3.804231215463631*^9, 
   3.80423136475117*^9}, {3.8042568865119314`*^9, 3.804257020695606*^9}, {
   3.80425870933119*^9, 3.8042587124963713`*^9}, {3.8042663795769033`*^9, 
   3.8042663910855618`*^9}, {3.804267392529841*^9, 3.804267407221681*^9}, {
   3.8042753729662957`*^9, 3.8042753825568447`*^9}, {3.8042765656645145`*^9, 
   3.804276589903901*^9}, {3.8042778970356646`*^9, 3.8042779235751824`*^9}, {
   3.804349437114996*^9, 3.804349478632371*^9}, {3.804349523803954*^9, 
   3.804349567339444*^9}, {3.8043513344005146`*^9, 3.8043513501304145`*^9}, {
   3.804397899720194*^9, 3.8043979253166575`*^9}, {3.8044004716643004`*^9, 
   3.8044004820818963`*^9}, {3.804400621542873*^9, 3.8044006359326963`*^9}, {
   3.8044014079768543`*^9, 3.8044014263689065`*^9}, {3.804402874730748*^9, 
   3.804402890216634*^9}, {3.8044133961841707`*^9, 3.8044134207275743`*^9}, {
   3.804416530546446*^9, 3.804416535617736*^9}, {3.80441748854524*^9, 
   3.8044174887872543`*^9}, {3.804418698865466*^9, 3.8044186993314934`*^9}, {
   3.804419433386479*^9, 3.804419434440539*^9}, {3.8044236285514283`*^9, 
   3.804423637055915*^9}, {3.8044236722619286`*^9, 3.8044236988434486`*^9}, 
   3.804425166117372*^9, {3.805015831962694*^9, 3.8050159011306505`*^9}, {
   3.80502761402759*^9, 3.8050276520487647`*^9}, {3.8050292579076147`*^9, 
   3.805029263824953*^9}, {3.805030388471279*^9, 3.8050305468533382`*^9}, {
   3.8050318092955456`*^9, 3.805031830668768*^9}, {3.8054637960903015`*^9, 
   3.8054638226571484`*^9}, {3.8055557333968544`*^9, 3.805555745611676*^9}, {
   3.8056108489771676`*^9, 3.8056108674007998`*^9}, {3.805626399834094*^9, 
   3.8056264170565243`*^9}, {3.8102070350982065`*^9, 
   3.8102070689512663`*^9}, {3.8102071056581306`*^9, 
   3.8102071460622015`*^9}, {3.810216062585081*^9, 3.8102160648152084`*^9}, {
   3.8102172122787533`*^9, 3.810217212382759*^9}, {3.8102221294396234`*^9, 
   3.8102221407022676`*^9}, {3.8102901844169865`*^9, 3.8102901989608183`*^9}, 
   3.8102902309316473`*^9, {3.810301083075354*^9, 3.81030111605024*^9}, {
   3.8103066137316895`*^9, 3.810306627714489*^9}, {3.810312201933316*^9, 
   3.810312236624301*^9}, {3.8103201272546186`*^9, 3.810320149920915*^9}, {
   3.8103224208318043`*^9, 3.810322440662938*^9}, {3.815920718869278*^9, 
   3.8159207767335877`*^9}, {3.8159208716130147`*^9, 
   3.8159208786364164`*^9}, {3.815921132089913*^9, 3.8159211993577604`*^9}, {
   3.8159217612699003`*^9, 3.8159217615649166`*^9}, {3.81592291920613*^9, 
   3.8159229221642995`*^9}, {3.8159235737005653`*^9, 3.8159236061164193`*^9}, 
   3.8159283663429127`*^9, {3.8159385325592966`*^9, 3.815938603014326*^9}, {
   3.8159797670950985`*^9, 3.815979796449777*^9}, 3.815979834116932*^9, {
   3.8159972170951815`*^9, 3.815997221745447*^9}, {3.815998144346217*^9, 
   3.8159981770210857`*^9}, 3.8159989354564657`*^9, {3.8159991568491287`*^9, 
   3.8159991685797997`*^9}, {3.815999207523027*^9, 3.8159992468112745`*^9}, {
   3.815999299901311*^9, 3.8159993033735094`*^9}, {3.816000796444908*^9, 
   3.8160007991240616`*^9}, {3.8160167948409643`*^9, 
   3.8160168040804925`*^9}, {3.816029035312079*^9, 3.816029093933432*^9}, {
   3.818951107866976*^9, 3.81895117602667*^9}, {3.818951208366227*^9, 
   3.818951240966209*^9}, {3.8233582812790956`*^9, 3.823358292021586*^9}, {
   3.82561718626643*^9, 
   3.825617200284009*^9}},ExpressionUUID->"e20782e1-278e-436a-803a-\
2d291ea0e226"],

Cell[BoxData[
 RowBox[{"Print", "[", "\"\<Model settings successful!\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.815921238918023*^9, 3.8159212522567863`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"3d241b05-e785-493b-900d-ef6a67305bdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<finiteTv: \>\"", ",", "finiteTv"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<finiteTx: \>\"", ",", "finiteTx"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<finiteT\[CapitalOmega]: \>\"", ",", "finiteT\[CapitalOmega]"}], "]"}],
   ";"}]}], "Input",ExpressionUUID->"9d40c929-8b43-4611-b372-104b7da9662d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["algorithm settings", "Subsection",ExpressionUUID->"51952953-54de-4bd2-82dd-695439e3099f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"timeFunc", "[", "tau_", "]"}], " ", "lets", " ", "you", " ", 
     "adjust", " ", "the", " ", "temporal", " ", "gaps", " ", "between", " ", 
     "the", " ", "mesh", " ", "points"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"where", " ", "0"}], " ", "\[LessEqual]", " ", "tau", " ", 
      "\[LessEqual]", " ", "1"}], ";", " ", 
     RowBox[{
     "to", " ", "use", " ", "one", " ", "of", " ", "the", " ", "supplied", 
      " ", "time", " ", "functions", " ", "just", " ", "uncomment", " ", "it",
       " ", "and", " ", "comment", " ", "the", " ", "other", " ", "one"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "you", " ", "can", " ", "also", " ", "create", " ", "your", " ", "own", 
      " ", "time", " ", "function"}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      RowBox[{"timeFunc", "[", "0", "]"}]}], " ", "=", " ", "0"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"1.", " ", "supplied", " ", "time", " ", 
     RowBox[{"function", ":", " ", "linear"}]}], ",", " ", 
    RowBox[{
    "tParam", " ", "regulates", " ", "the", " ", "size", " ", "of", " ", 
     "the", " ", "time", " ", 
     RowBox[{"interval", " ", "[", 
      RowBox[{"0", ",", "tParam"}], "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tParam", " ", "=", " ", "40"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeFunc", "[", "tau_", "]"}], " ", ":=", " ", 
     RowBox[{"tParam", " ", "*", " ", "tau"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"invtimeFunc", "[", "tau_", "]"}], ":=", 
     FractionBox["tau", "tParam"]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"2.", " ", "supplied", " ", "time", " ", 
      RowBox[{"function", ":", " ", "nonlinear"}]}], ",", " ", 
     RowBox[{
     "tParam", " ", "regulates", " ", "the", " ", "distribution", " ", "of", 
      " ", "the", " ", "mesh", " ", "points", " ", "over", " ", "time", " ", 
      "akin", " ", "to", " ", "some", " ", "density", " ", "parameter"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tParam", " ", "=", " ", "10"}], ";", "\n", 
     RowBox[{
      RowBox[{"timeFunc", "[", "tau_", "]"}], " ", ":=", " ", 
      RowBox[{"tau", " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"tParam", " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "tau"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"invtimeFunc", "[", "tau_", "]"}], ":=", 
      FractionBox[
       RowBox[{"tParam", "*", "tau"}], 
       RowBox[{
        RowBox[{"tParam", "*", "tau"}], "+", "1"}]]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeMax", " ", "=", " ", "10"}], ";"}], "    ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "time", " ", "paths", " ", "will", " ", "be", " ", "shown", " ", "in", 
     " ", "the", " ", 
     RowBox[{"interval", " ", "[", 
      RowBox[{"0", ",", "timeMax"}], "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meshPoints", " ", "=", " ", "21"}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"number", " ", "of", " ", "mesh", " ", "points"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"equilibriumPrecision", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "9"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "precision", " ", "of", " ", "the", " ", "equilibrium", " ", "at", " ", 
      "finalValues"}], " ", "*)"}], "\n", 
    RowBox[{"errorCondFunc", " ", "=", "  ", "\"\<mean\>\""}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\"\<mean\>\"", " ", "or", " ", "\"\<max\>\"", " ", "function", " ", 
      "to", " ", "control", " ", "when", " ", "solution", " ", "is", " ", 
      "precise", " ", "enough"}], " ", "*)"}], "\n", 
    RowBox[{"solutionPrecision", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "9"}]}]}], " ", ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"(", "relative", ")"}], " ", "precision", " ", "of", " ", "the",
       " ", "solution"}], " ", "*)"}], "\n", 
    RowBox[{"iterMax", " ", "=", " ", "80"}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"maximum", " ", "number", " ", "of", " ", "iterations"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"minSolutionValue", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "nonpositive", " ", "values", " ", "are", " ", "not", " ", "allowed", 
       " ", "in", " ", "Jacobi", " ", "matrix"}], ";", " ", 
      RowBox[{
      "they", " ", "are", " ", "set", " ", "to", " ", "minSolutionValue"}]}], 
     " ", "*)"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.392397509078125*^9, 3.39239751228125*^9}, {
   3.79456968542423*^9, 3.7945696874573464`*^9}, 3.7945697973046293`*^9, {
   3.794570629987256*^9, 3.7945706302782726`*^9}, {3.7945707449298306`*^9, 
   3.794570744978833*^9}, {3.7945709550738497`*^9, 3.7945709573069773`*^9}, {
   3.7945712218201065`*^9, 3.7945712225961514`*^9}, {3.7945728664891768`*^9, 
   3.7945728665281787`*^9}, {3.7945950701374426`*^9, 3.794595070355455*^9}, 
   3.7958668584418135`*^9, {3.795931472082215*^9, 3.7959314723102283`*^9}, {
   3.7960099334594464`*^9, 3.7960099418299255`*^9}, {3.7960100314390507`*^9, 
   3.7960100406885796`*^9}, 3.796010110070548*^9, 3.796010209715247*^9, {
   3.7960158059076543`*^9, 3.796015806302677*^9}, {3.7966631163351517`*^9, 
   3.7966631169781885`*^9}, {3.796725380255287*^9, 3.796725380619308*^9}, 
   3.796725505434447*^9, {3.7967257284772043`*^9, 3.7967257286182127`*^9}, {
   3.7981707063223934`*^9, 3.798170706449401*^9}, {3.798171224055006*^9, 
   3.798171224183013*^9}, {3.798182728908416*^9, 3.798182729034423*^9}, {
   3.7981831596630535`*^9, 3.7981831597650595`*^9}, 3.798183626965781*^9, {
   3.79818371260168*^9, 3.7981837184760156`*^9}, {3.798289236936764*^9, 
   3.798289237027769*^9}, {3.7996120781132154`*^9, 3.7996120782762246`*^9}, {
   3.7996123652909994`*^9, 3.799612365333002*^9}, {3.7996125589408402`*^9, 
   3.799612560035903*^9}, {3.801221920454887*^9, 3.80122192086191*^9}, {
   3.8012224272678747`*^9, 3.8012224279769154`*^9}, {3.8012251496675873`*^9, 
   3.8012251498876*^9}, {3.8012254956223745`*^9, 3.801225495772383*^9}, 
   3.8012258231921105`*^9, {3.8012261134157104`*^9, 3.801226119732072*^9}, {
   3.801226523977193*^9, 3.801226538719036*^9}, {3.801227371306658*^9, 
   3.801227386085503*^9}, {3.801234448226988*^9, 3.8012344485150046`*^9}, {
   3.8012348086966057`*^9, 3.8012348089046173`*^9}, {3.80150320629667*^9, 
   3.801503206681136*^9}, {3.801503535296639*^9, 3.8015035545637407`*^9}, {
   3.801503779103232*^9, 3.80150377931443*^9}, {3.801503949853039*^9, 
   3.8015039499921618`*^9}, {3.801504172185532*^9, 3.8015041729263573`*^9}, {
   3.801504393832246*^9, 3.801504393985383*^9}, {3.8015503540732107`*^9, 
   3.801550355169167*^9}, 3.8015508702357426`*^9, 3.8015510171571465`*^9, 
   3.8015517940375814`*^9, {3.801552147243784*^9, 3.801552156600319*^9}, {
   3.8015522541889005`*^9, 3.8015522589241714`*^9}, {3.8031168250450563`*^9, 
   3.803116828119232*^9}, {3.803117789381213*^9, 3.8031178010938835`*^9}, {
   3.803117933994485*^9, 3.8031179341004906`*^9}, {3.803118949627576*^9, 
   3.8031189497145805`*^9}, {3.803120831543215*^9, 3.8031208317482266`*^9}, {
   3.803129309751725*^9, 3.8031293099287353`*^9}, {3.80313067599387*^9, 
   3.803130696329033*^9}, {3.8032057954810424`*^9, 3.80320580121237*^9}, {
   3.803206051717698*^9, 3.8032060644044237`*^9}, {3.80320614947429*^9, 
   3.8032061766078415`*^9}, 3.803208190145009*^9, 3.8032083678041706`*^9, {
   3.803208397949895*^9, 3.8032084055823317`*^9}, 3.8032085023848686`*^9, 
   3.8032181803724174`*^9, {3.8032318678910675`*^9, 3.8032318727653465`*^9}, {
   3.8033834854665737`*^9, 3.8033834880187197`*^9}, 3.803385370557395*^9, {
   3.804179926223542*^9, 3.8041799263185472`*^9}, {3.804184271783094*^9, 
   3.8041842754583044`*^9}, {3.8041863462267456`*^9, 3.804186348964902*^9}, {
   3.804189046848999*^9, 3.804189052625329*^9}, {3.80418979096956*^9, 
   3.804189794621769*^9}, {3.804191018038745*^9, 3.804191026776244*^9}, {
   3.804193290726735*^9, 3.804193293493893*^9}, {3.804194182946767*^9, 
   3.804194191520257*^9}, {3.80419807518139*^9, 3.8041980787945967`*^9}, {
   3.804257693778104*^9, 3.8042576945881505`*^9}, {3.8042579954973617`*^9, 
   3.8042579957243743`*^9}, {3.804349575166892*^9, 3.8043495753489027`*^9}, {
   3.8043965410784836`*^9, 3.804396543358614*^9}, {3.805014866937498*^9, 
   3.805014910933015*^9}, {3.8050150301278324`*^9, 3.805015044991682*^9}, {
   3.8050177650282593`*^9, 3.805017824802678*^9}, {3.805027665809552*^9, 
   3.805027668256692*^9}, {3.8050305745199203`*^9, 3.805030582785393*^9}, {
   3.8050318555871935`*^9, 3.8050318607974916`*^9}, 3.8050980570609555`*^9, 
   3.805100258116849*^9, {3.805104077891328*^9, 3.8051041030547667`*^9}, 
   3.8051095465621176`*^9, {3.8051290353742294`*^9, 3.805129035758251*^9}, 
   3.8051292115693073`*^9, {3.8051302602242866`*^9, 3.8051302604883013`*^9}, {
   3.805166270378624*^9, 3.8051662706106377`*^9}, {3.805190642316619*^9, 
   3.8051906423626223`*^9}, 3.805194554535385*^9, {3.805194589293373*^9, 
   3.8051945980378733`*^9}, {3.805194736130772*^9, 3.8051947495925417`*^9}, {
   3.80519882042038*^9, 3.805198851806175*^9}, {3.805199013717436*^9, 
   3.8051990243770456`*^9}, {3.805199119353478*^9, 3.8051991350893784`*^9}, {
   3.8052040321834755`*^9, 3.805204047034325*^9}, {3.8053747835126934`*^9, 
   3.805374783762294*^9}, 3.8054802213801317`*^9, {3.805514506661806*^9, 
   3.8055145251634383`*^9}, 3.810207209772713*^9, {3.810208216501525*^9, 
   3.8102082167043257`*^9}, {3.8102087328708334`*^9, 3.8102087330268335`*^9}, 
   3.8159212629874*^9, 3.815933335540044*^9, 3.8159938165966835`*^9, {
   3.815997176972886*^9, 3.8159971782009563`*^9}, {3.8159986398575583`*^9, 
   3.8159986477600107`*^9}, 3.8159986856131754`*^9, {3.8160008059474516`*^9, 
   3.816000826860648*^9}, 3.816001033483466*^9, 3.8160169202741385`*^9, 
   3.816018510938119*^9, 3.818231821067362*^9, 3.818945032533123*^9, 
   3.81912082535432*^9, {3.8233563104791403`*^9, 3.8233563108104763`*^9}, {
   3.824665468657111*^9, 3.8246654688730507`*^9}, {3.8246673444263*^9, 
   3.824667369947822*^9}, {3.824714661572583*^9, 3.824714662673171*^9}, {
   3.824727362766315*^9, 3.82472736891695*^9}, {3.8291623129803133`*^9, 
   3.829162313225987*^9}, {3.82937388853826*^9, 
   3.8293738886184797`*^9}},ExpressionUUID->"b920c783-e441-427a-aad5-\
71683f9b246e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<Algorithm settings successful!\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Entering computation...\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.815921266750615*^9, 3.8159212858447075`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"0c65297c-1d79-4715-9bab-0a4cbaace970"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation", "Section",ExpressionUUID->"c04f9508-2949-444a-a368-e24a4426aeaf"],

Cell[CellGroupData[{

Cell["check for user input errors", "Subsection",ExpressionUUID->"b60879b4-e09d-4f6a-9ba8-a6839efb3a44"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nTotal", " ", "=", " ", 
    RowBox[{"nInitial", "+", "nFinal", "+", "nStatic"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"relax", "::", "numberOfVariables1"}], " ", "=", "\n", "\t", 
   "\"\<Error: The total number of equations in fODE[] and fSTAT[] is not \
equal to the number of variables, nInitial+nFinal+nStatic.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"relax", "::", "numberOfVariables2"}], " ", "=", "\n", "\t", 
   "\"\<Error: The total number of equations in fODE[] and fSTAT[] is not \
equal to the number of variable names in variableNames (without time \
t).\>\""}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"SameQ", "[", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"fSTAT", ",", "initialValues"}], "]"}], "]"}], ",", " ", 
      "List"}], "]"}], ",", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"fSTAT", "[", "]"}], " ", "has", " ", "been", " ", "defined"}], 
     " ", "*)"}], "\n", "\t", 
    RowBox[{"countFunc", " ", "=", " ", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"fODE1", ",", "initialValues"}], "]"}], "]"}], " ", "+", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"fSTAT", ",", "initialValues"}], "]"}], "]"}]}]}], ",", "\n", 
    "\t", 
    RowBox[{"(*", " ", "else", " ", "*)"}], "\n", "\t", 
    RowBox[{"countFunc", " ", "=", " ", 
     RowBox[{"Length", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{"fODE1", ",", "initialValues"}], "]"}], "]"}]}]}], "\n", "]"}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"countFunc", " ", "\[NotEqual]", " ", "nTotal"}], ",", " ", 
    RowBox[{"Message", "[", 
     RowBox[{"relax", "::", "numberOfVariables1"}], "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"countFunc", " ", "\[NotEqual]", " ", 
      RowBox[{
       RowBox[{"Length", "[", "variableNames", "]"}], "-", "1"}]}], ",", " ", 
     RowBox[{"Message", "[", 
      RowBox[{"relax", "::", "numberOfVariables2"}], "]"}]}], "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"relax", "::", "convergenceFinalValues"}], " ", "=", " ", 
   "\"\<Warning: finalValues does not seem to be an equilibrium point; not \
each value of fODE and/or fSTAT is near enough to zero, i.e. in the interval \
[-equilibriumPrecision, equilibriumPrecision] = [-`1`, `1`].\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"fODE1", ",", "finalValues"}], "]"}], "]"}], "]"}], ">", 
       "equilibriumPrecision"}], " ", "||", " ", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"fSTAT", ",", "finalValues"}], "]"}], "]"}], " ", ">", " ", 
       "equilibriumPrecision"}]}], ",", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"relax", "::", "convergenceFinalValues"}], ",", " ", 
       "equilibriumPrecision"}], "]"}]}], "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Caution", ":", " ", 
     RowBox[{
     "if", " ", "you", " ", "allow", " ", "more", " ", "than", " ", 
      "\"\<mean\>\"", " ", "or", " ", "\"\<max\>\"", " ", "as", " ", 
      "keywords", " ", "for", " ", "constructing", " ", "the", " ", 
      "relative", " ", "error"}]}], ",", " ", 
    RowBox[{
    "do", " ", "not", " ", "forget", " ", "to", " ", "change", " ", "the", 
     " ", "definition", " ", "of", " ", "relError", " ", "at", " ", "the", 
     " ", "end", " ", "of", " ", "the", " ", "while", " ", "loop", " ", "in", 
     " ", "the", " ", "last", " ", "subsection", " ", "of", " ", "the", " ", 
     "computation", " ", "part"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"relax", "::", "errorCondFunc"}], " ", "=", " ", 
   "\"\<Warning: The value \\\"`1`\\\" you used for the string variable \
errorCondFunc is not allowed; use \\\"mean\\\" or \\\"max\\\" instead. In \
this run \\\"max\\\" will be used.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"errorCondFunc", "!=", "\"\<mean\>\""}], "&&", 
     RowBox[{"errorCondFunc", "!=", "\"\<max\>\""}]}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"relax", "::", "\"\<errorCondFunc\>\""}], ",", 
       "errorCondFunc"}], "]"}], ";", "\n", "\t", 
     RowBox[{"errorCondFunc", " ", "=", " ", "\"\<max\>\""}], ";"}]}], "\n", 
   "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[114]:=",ExpressionUUID->"8b0af1d2-33e8-48d4-8d15-d11de573e27b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<Check for user input errors successful!\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8159212944011965`*^9, 3.815921306476887*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"35e4b6c7-ae0e-43e8-b8c3-df5eef38b10a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["computing boolean variables which reflect user input:", "Subsection",ExpressionUUID->"ea0e0212-1d6e-4ffe-96d2-790055147bc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"existStaticEq", " ", "=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"nStatic", " ", ">", " ", "0"}], ",", "True", ",", "False"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"existFinalEq", " ", "=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ValueQ", "[", "finalEqIndex", "]"}], ",", "True", ",", 
     "False"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[123]:=",ExpressionUUID->"12a02e8e-6f9d-4d4f-b9b2-1b670c1ed3a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", "\"\<Computing booleans successful!\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.815921311311164*^9, 3.815921323259847*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"62f02ad5-d9f9-4d39-8dfd-080dc09f09e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
computing the derivative of the time function, and the length of a time step\
\>", "Subsection",ExpressionUUID->"68f0c5fe-5876-4aac-9004-ccb02aa1e44d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "construction", " ", "of", " ", "the", " ", "derivative", " ", "of", " ", 
    "the", " ", "time", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"timeFuncDerivat", "[", "tau_", "]"}], " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"timeFunc", "[", "timeVar", "]"}], ",", " ", "timeVar"}], 
         "]"}], "]"}], " ", "/.", " ", 
       RowBox[{"timeVar", "\[Rule]", "tau"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"invtimeFuncDerivat", "[", "tau_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"invtimeFunc", "[", "timeVar", "]"}], ",", " ", "timeVar"}],
          "]"}], "]"}], " ", "/.", " ", 
       RowBox[{"timeVar", "\[Rule]", "tau"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"deltaTau", " ", "=", " ", 
     RowBox[{"1", " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{"meshPoints", " ", "-", " ", "1"}], ")"}]}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"remember", ":", " ", 
      RowBox[{
      "0", " ", "\[LessEqual]", " ", "tau", " ", "\[LessEqual]", " ", "1"}]}],
      ",", " ", 
     RowBox[{"and", " ", "the", " ", 
      RowBox[{"interval", " ", "[", 
       RowBox[{"0", ",", "1"}], "]"}], " ", "will", " ", "be", " ", 
      "linearly", " ", "spaced", " ", "with", " ", "timestep", " ", 
      "deltaTau"}]}], " ", "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8050149321222267`*^9, 3.805014967617257*^9}, {
  3.8050150215833435`*^9, 3.805015024914534*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"f6cdaa36-3a23-4455-8fb1-d8054abad5c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Computing the derivative of the time function successful!\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Entering computation of the first instances of the solution and error \
vectors...\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8159213316163254`*^9, 3.8159213776919603`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"bcfc2c23-75a0-45e7-9adf-d465f3f48e4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "computing the first instances of the solution and error vectors ",
 StyleBox["solution",
  FontSlant->"Italic"],
 " and ",
 StyleBox["error",
  FontSlant->"Italic"],
 ", and computing the time vector ",
 StyleBox["timeList",
  FontSlant->"Italic"]
}], "Subsection",ExpressionUUID->"8c7a177c-06db-446c-adcf-020c21d09376"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"solution", ":", 
       RowBox[{"solution", " ", "vector", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"var_", "1", 
           RowBox[{"(", "t", ")"}]}], ",", 
          RowBox[{"var_", "2", 
           RowBox[{"(", "t", ")"}]}], ",", "...", ",", 
          RowBox[{"var_n", 
           RowBox[{"(", "t", ")"}]}]}], ")"}]}]}], ";", 
      RowBox[{
      "will", " ", "continually", " ", "be", " ", "updated", " ", "by", " ", 
       "the", " ", "algorithm", "\n", "   ", 
       RowBox[{"error", ":", 
        RowBox[{"error", " ", "function"}]}]}]}], ",", 
     RowBox[{
     "which", " ", "should", " ", "vanish", " ", "by", " ", "iteratively", 
      " ", "updating", " ", "solution"}]}], "\n", "*)"}],
   FontTracking->"Plain",
   FontVariations->{"CompatibilityType"->0,
   "Outline"->False,
   "Shadow"->False,
   "StrikeThrough"->False,
   "Underline"->False},
   FontVariations -> {"Masked" -> False},
   FontVariations -> {"RotationAngle" -> 0}], 
  StyleBox["\n",
   FontTracking->"Plain",
   FontVariations->{"CompatibilityType"->0,
   "Outline"->False,
   "Shadow"->False,
   "StrikeThrough"->False,
   "Underline"->False},
   FontVariations -> {"Masked" -> False},
   FontVariations -> {"RotationAngle" -> 0}], 
  StyleBox["\n",
   FontTracking->"Plain",
   FontVariations->{"CompatibilityType"->0,
   "Outline"->False,
   "Shadow"->False,
   "StrikeThrough"->False,
   "Underline"->False},
   FontVariations -> {"Masked" -> False},
   FontVariations -> {"RotationAngle" -> 0}], 
  RowBox[{
   StyleBox["(*",
    FontTracking->"Plain",
    FontVariations->{"CompatibilityType"->0,
    "Outline"->False,
    "Shadow"->False,
    "StrikeThrough"->False,
    "Underline"->False}], " ", 
   RowBox[{
    RowBox[{"solution", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"finalValues", ",", 
        RowBox[{"{", "meshPoints", "}"}]}], "]"}], "]"}]}], ";"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], "}"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "finalValues", "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"meshPoints", "-", "1"}], ")"}]}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"finalValues", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"errorFinal", " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{"existFinalEq", ",", "\n", "\t", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"fODE", ",", 
         RowBox[{"solution", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], "+",
               "1"}], ",", 
             RowBox[{"meshPoints", "*", "nTotal"}]}], "]"}], "]"}], "]"}]}], 
        "]"}], "[", 
       RowBox[{"[", "finalEqIndex", "]"}], "]"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
             "nInitial", "+", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
             "nInitial", "+", "nFinal"}]}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"finalValues", "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"nInitial", "+", "1"}], ",", 
            RowBox[{"nInitial", "+", "nFinal"}]}], "]"}], "]"}], "]"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
            "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
            "nFinal"}]}], "]"}], "]"}], "]"}], "-", 
       RowBox[{"finalValues", "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "nFinal"}], "]"}], "]"}], "]"}]}]}], "\n", " ", 
     "]"}]}], "\n", 
   RowBox[{
    RowBox[{"error", " ", "=", " ", 
     RowBox[{"If", "[", 
      RowBox[{"existStaticEq", ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"solution", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", "nInitial", "]"}], "]"}], "]"}], "-", 
           RowBox[{"initialValues", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", "nInitial", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"fSTAT", ",", 
            RowBox[{"solution", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", "nTotal", "]"}], "]"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                  "-", 
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"nTotal", "-", "nStatic"}]}], "}"}]}], "]"}], "-", 
               RowBox[{"deltaTau", "*", 
                RowBox[{"Apply", "[", 
                 RowBox[{"fODE", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "nTotal"}], "}"}]}], "]"}]}], 
                 "]"}], " ", "*", "  ", 
                RowBox[{"timeFuncDerivat", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                 "]"}]}]}], ",", 
              RowBox[{"Apply", "[", 
               RowBox[{"fSTAT", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", "nTotal"}], "}"}]}], "]"}]}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"meshPoints", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "errorFinal"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"solution", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", 
              RowBox[{"nInitial", "-", "1"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{"initialValues", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", 
              RowBox[{"nInitial", "-", "1"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"solution", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "-", 
           RowBox[{"initialValues", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                  "-", 
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"nTotal", "-", "nStatic"}]}], "}"}]}], "]"}], "-", 
               RowBox[{"deltaTau", "*", 
                RowBox[{"Apply", "[", 
                 RowBox[{"fODE", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "nTotal"}], "}"}]}], "]"}]}], 
                 "]"}], " ", "*", "  ", 
                FractionBox["1", 
                 RowBox[{"invtimeFuncDerivat", "[", "time", "]"}]]}]}], "}"}],
              "/.", 
             RowBox[{"time", "\[Rule]", 
              RowBox[{"timeFunc", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                  "+", " ", 
                  RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
               "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"meshPoints", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "errorFinal"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tauListReduced", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"1", "-", "deltaTau"}], ",", "deltaTau"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"timeFunc", "[", "1", "]"}], " ", "may", " ", "not", " ", "be", 
      " ", "a", " ", "real", " ", "number"}], " ", "\[Rule]", " ", 
     RowBox[{"insert", " ", "Infinity"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Power", "::", "infy"}], "]"}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"timeList", " ", "=", " ", 
     RowBox[{"N", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"timeFunc", ",", "tauListReduced"}], "]"}], ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumberQ", "[", 
           RowBox[{"timeFunc", "[", "1", "]"}], "]"}], ",", 
          RowBox[{"timeFunc", "[", "1", "]"}], ",", "Infinity"}], "]"}]}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"On", "[", 
     RowBox[{"Power", "::", "infy"}], "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.795866440664052*^9, 3.7958664679281025`*^9}, {
   3.7958669022723207`*^9, 3.795866919288294*^9}, {3.7959315205159855`*^9, 
   3.795931551268744*^9}, {3.795952563081992*^9, 3.7959525726765404`*^9}, {
   3.795953116024618*^9, 3.795953126582222*^9}, {3.7959531585490503`*^9, 
   3.7959531639743605`*^9}, {3.796010220982892*^9, 3.7960102238630567`*^9}, {
   3.796646055020841*^9, 3.7966461215166445`*^9}, {3.7966463309596243`*^9, 
   3.7966463473875637`*^9}, {3.796646544965864*^9, 3.7966465620828433`*^9}, 
   3.796646627515586*^9, {3.796663139349468*^9, 3.7966631575855117`*^9}, {
   3.7967252510818987`*^9, 3.796725254717107*^9}, {3.7967254073058343`*^9, 
   3.7967254104320135`*^9}, {3.798170753667101*^9, 3.7981707648237395`*^9}, {
   3.798170888109791*^9, 3.798170904734742*^9}, {3.7981832605098214`*^9, 
   3.7981832682272625`*^9}, {3.798315195073703*^9, 3.798315238324177*^9}, {
   3.798315448374191*^9, 3.798315448782214*^9}, {3.8012243332238894`*^9, 
   3.8012243449895625`*^9}, {3.8012243767413783`*^9, 
   3.8012243778234406`*^9}, {3.801224442673149*^9, 3.801224446305357*^9}, {
   3.801229085968731*^9, 3.8012291124212437`*^9}, {3.8012347056257105`*^9, 
   3.801234706875782*^9}, {3.801234776093741*^9, 3.8012347830611396`*^9}, {
   3.8032058244687004`*^9, 3.8032058342852616`*^9}, {3.803206083801533*^9, 
   3.803206086743702*^9}, {3.8032321840091486`*^9, 3.8032321900564947`*^9}, {
   3.8050150895852327`*^9, 3.805015117694841*^9}, {3.8050151495986657`*^9, 
   3.8050151606142955`*^9}, {3.8050151962453337`*^9, 
   3.8050152075569806`*^9}, {3.8050159570378485`*^9, 
   3.8050159577768908`*^9}, {3.805027689574911*^9, 3.805027702005622*^9}, {
   3.8050306294860644`*^9, 3.805030634189334*^9}, {3.8050307388213177`*^9, 
   3.8050308218240657`*^9}, {3.8050308687657504`*^9, 
   3.8050309027726955`*^9}, {3.80503094342002*^9, 3.805030946441193*^9}, {
   3.8050326687107015`*^9, 3.8050326786252685`*^9}, {3.805130229494529*^9, 
   3.8051302363169193`*^9}, {3.805166292067865*^9, 3.805166296580123*^9}, {
   3.8051908505185275`*^9, 3.8051908509495525`*^9}, 3.820843433855166*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"790ebee2-748d-478a-b999-5cfe94471880"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Successful calculation of the first solution and error vectors!\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<Entering the relaxation stage...\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Solution: \>\"", ",", "solution"}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Error: \>\"", ",", "error"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8159213815381804`*^9, 3.8159213874355183`*^9}, {
  3.8159216646313725`*^9, 3.81592168713766*^9}, {3.8159225952235994`*^9, 
  3.81592262881052*^9}, {3.8159229781465015`*^9, 3.815922982410745*^9}, {
  3.818232383746757*^9, 
  3.818232397904516*^9}},ExpressionUUID->"5fc033e2-98ba-4e9e-b4b8-\
1fa3035dcab4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Jacobian matrix ",
 StyleBox["jac",
  FontSlant->"Italic"],
 " is constructed, so that ",
 StyleBox["jac",
  FontSlant->"Italic"],
 "(",
 StyleBox["solution",
  FontSlant->"Italic"],
 ") * ",
 StyleBox["deltaSolution",
  FontSlant->"Italic"],
 " = -",
 StyleBox["error",
  FontSlant->"Italic"],
 "(",
 StyleBox["solution",
  FontSlant->"Italic"],
 ") can be solved for ",
 StyleBox["deltaSolution",
  FontSlant->"Italic"],
 " and ",
 StyleBox["deltaSolution",
  FontSlant->"Italic"],
 " added to ",
 StyleBox["solution",
  FontSlant->"Italic"],
 ". This will be iterated until the relative error, i.e. ",
 StyleBox["error",
  FontSlant->"Italic"],
 "/",
 StyleBox["solution",
  FontSlant->"Italic"],
 ", is smaller than ",
 StyleBox["solutionPrecision",
  FontSlant->"Italic"],
 " or the maximum number of iterations, ",
 StyleBox["iterMax",
  FontSlant->"Italic"],
 ", has been reached. Then the solution matrix with (",
 StyleBox["time",
  FontSlant->"Italic"],
 ", ",
 StyleBox["var_1",
  FontSlant->"Italic"],
 ", ",
 StyleBox["var_2",
  FontSlant->"Italic"],
 ", ..., ",
 StyleBox["var_n",
  FontSlant->"Italic"],
 ") is constructed."
}], "Subsection",ExpressionUUID->"2c48a524-1576-4980-8494-b5087024d737"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tComputation", " ", "=", " ", 
   RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Jacobi", " ", "matrix", " ", "jac", " ", "consists", " ", "of", " ", 
       "blocks", " ", "jacLeft", " ", "and", " ", "jacRight", " ", "which", 
       " ", "are", " ", "first", " ", "constructed", " ", "in", " ", 
       "symbolic", " ", "form"}], ",", " ", 
      RowBox[{
      "to", " ", "be", " ", "filled", " ", "in", " ", "later", " ", "with", 
       " ", "real", " ", 
       RowBox[{"values", ".", " ", "The"}], " ", "last", " ", "rows", " ", 
       "of", " ", "jac", " ", "depend", " ", "on", " ", "whether", " ", 
       "final", " ", "conditions", " ", "are", " ", "given", " ", "directly", 
       " ", "by", " ", "concrete", " ", "values", " ", "in", " ", 
       "finalValues", " ", "or", " ", "indirectly", " ", "by", " ", "ODEs", 
       " ", "which", " ", "have", " ", "to", " ", "be", " ", "fullfilled", 
       " ", "at", " ", "the", " ", "end"}], ",", " ", 
      RowBox[{"designated", " ", "by", " ", "finalEqIndex"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"upper", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"xUpper", "[", "i", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nTotal"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lower", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"xLower", "[", "i", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nTotal"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<About to create bulk of symbolical Jacobian...\>\"", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"existStaticEq", ",", 
       RowBox[{
        RowBox[{"jacLeft", " ", "=", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"upper", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", 
                  RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
               "-", 
               RowBox[{"lower", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", 
                  RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
               "-", 
               RowBox[{"deltaTau", "*", 
                RowBox[{"Apply", "[", 
                 RowBox[{"fODE", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"upper", "+", "lower"}], ")"}], "/", "2"}]}], 
                 "]"}], "*", 
                RowBox[{"timeFuncDerivat", "[", "tau", "]"}]}]}], ",", 
              RowBox[{"Apply", "[", 
               RowBox[{"fSTAT", ",", "upper"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", "lower", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jacRight", " ", "=", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"upper", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", 
                  RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
               "-", 
               RowBox[{"lower", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", 
                  RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
               "-", 
               RowBox[{"deltaTau", "*", 
                RowBox[{"Apply", "[", 
                 RowBox[{"fODE", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"upper", "+", "lower"}], ")"}], "/", "2"}]}], 
                 "]"}], "*", 
                RowBox[{"timeFuncDerivat", "[", "tau", "]"}]}]}], ",", 
              RowBox[{"Apply", "[", 
               RowBox[{"fSTAT", ",", "upper"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", "upper", "}"}]}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jacLeft", " ", "=", " ", "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"deriv", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"upper", "[", 
                  RowBox[{"[", 
                   RowBox[{"Range", "[", 
                    RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
                 "-", 
                 RowBox[{"lower", "[", 
                  RowBox[{"[", 
                   RowBox[{"Range", "[", 
                    RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
                 "-", 
                 RowBox[{"deltaTau", "*", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"fODE", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"upper", "+", "lower"}], ")"}], "/", "2"}]}], 
                   "]"}], "*", 
                  FractionBox["1", 
                   RowBox[{"invtimeFuncDerivat", "[", "time", "]"}]]}]}], 
                "}"}], "]"}], ",", 
              RowBox[{"lower", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"nInitial", "+", "nFinal"}]}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"jacRight", " ", "=", " ", "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"deriv", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"upper", "[", 
                  RowBox[{"[", 
                   RowBox[{"Range", "[", 
                    RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
                 "-", 
                 RowBox[{"lower", "[", 
                  RowBox[{"[", 
                   RowBox[{"Range", "[", 
                    RowBox[{"nInitial", "+", "nFinal"}], "]"}], "]"}], "]"}], 
                 "-", 
                 RowBox[{"deltaTau", "*", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"fODE", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"upper", "+", "lower"}], ")"}], "/", "2"}]}], 
                   "]"}], "*", 
                  FractionBox["1", 
                   RowBox[{"invtimeFuncDerivat", "[", "time", "]"}]]}]}], 
                "}"}], "]"}], ",", 
              RowBox[{"upper", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"nInitial", "+", "nFinal"}]}], "}"}]}], "]"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Done creating bulk of symbolical Jacobian...\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<About to create jacFinal...\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"jacFinal", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"existFinalEq", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nInitial", "+", "nStatic", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
                 "+", "j"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
                 "+", "k"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", "nFinal"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nTotal"}], "}"}]}], "]"}], ",", "1"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"Apply", "[", 
                 RowBox[{"fODE", ",", "lower"}], "]"}], ",", " ", 
                RowBox[{"{", "lower", "}"}]}], "]"}], " ", "/.", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{"RuleDelayed", ",", 
                RowBox[{"{", 
                 RowBox[{"lower", ",", 
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
                    "+", "1"}], ",", 
                    RowBox[{"meshPoints", "*", "nTotal"}]}], "]"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}]}], ")"}], "[", 
            RowBox[{"[", "finalEqIndex", "]"}], "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nInitial", "+", "nStatic", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
                "+", "j"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
                "+", "nInitial", "+", "j"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "nFinal"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", " ", 
             RowBox[{"{", "nFinal", "}"}]}], "]"}]}], "}"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nInitial", "+", "nStatic", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
               "+", "j"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"meshPoints", "-", "1"}], ")"}], "*", "nTotal"}], 
               "+", "j"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "nFinal"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", " ", 
            RowBox[{"{", "nFinal", "}"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Done creating jacFinal...\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"relError", " ", "=", " ", 
      RowBox[{"solutionPrecision", " ", "+", " ", "1"}]}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "relError", " ", "must", " ", "initially", " ", "be", " ", "greater", 
       " ", "than", " ", "solutionPrecision", " ", "because", " ", "of", " ", 
       "head", " ", "of", " ", "while", " ", "loop", " ", "below"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"meanRelErrorList", " ", "=", " ", 
      RowBox[{"maxRelErrorList", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"used", " ", "for", " ", "bookkeeping"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"iterCount", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", "jacLeft", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", "jacRight", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<jacFinal: \>\"", ",", " ", "jacFinal"}], "]"}], ";"}], 
      "*)"}], "\n", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"In", " ", "the", " ", "following", " ", "while"}], "-", 
        RowBox[{
        "loop", " ", "the", " ", "Jacobi", " ", "matrix", " ", "jac", " ", 
         "is", " ", "constructed", " ", "as", " ", "a", " ", "Mathematica", 
         " ", "sparse", " ", 
         RowBox[{"array", ".", " ", "The"}], " ", "positions", " ", "of", " ",
          "the", " ", "nonzero", " ", "matrix", " ", "values", " ", "are", 
         " ", "stored", " ", "in", " ", "the", " ", "list", " ", 
         "jacPosition"}]}], ",", " ", 
       RowBox[{
       "the", " ", "values", " ", "themselves", " ", "are", " ", "stored", 
        " ", "in", " ", "the", " ", "list", " ", "jacValue"}], ",", " ", 
       RowBox[{
       "constructed", " ", "by", " ", "using", " ", "the", " ", "symbolic", 
        " ", "block", " ", "matrices", " ", "jacLeft"}], ",", " ", 
       RowBox[{
       "jacRight", " ", "and", " ", "the", " ", "symbolic", " ", "final", " ",
         "matrix", " ", 
        RowBox[{"jacFinal", ".", " ", "During"}], " ", "the", " ", "process", 
        " ", "of", " ", "adding", " ", "matrix", " ", "blocks", " ", "the", 
        " ", "lists", " ", "jacPosition", " ", "and", " ", "jacValue", " ", 
        "get", " ", "deeply", " ", "nested"}], ",", " ", 
       RowBox[{
       "only", " ", "to", " ", "be", " ", "flattened", " ", "in", " ", "the", 
        " ", "end"}], ",", " ", 
       RowBox[{
        RowBox[{
        "just", " ", "before", " ", "constructing", " ", "the", " ", "sparse",
          " ", "array"}], ";", " ", 
        RowBox[{
        "this", " ", "looks", " ", "ugly", " ", "but", " ", "is", " ", "more",
          " ", "efficient", " ", "than", " ", "flattening", " ", "the", " ", 
         "lists", " ", "every", " ", "time", " ", "after", " ", "appending", 
         " ", "another", " ", 
         RowBox[{"block", ".", "\[IndentingNewLine]", "After"}], " ", "the", 
         " ", "sparse", " ", "matrix", " ", "jac", " ", "has", " ", "been", 
         " ", "constructed"}]}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "equation", " ", "jac", 
         RowBox[{"(", "solution", ")"}], "*", "deltaSolution"}], " ", "=", 
        " ", 
        RowBox[{
         RowBox[{"-", "error"}], 
         RowBox[{"(", "solution", ")"}], " ", "is", " ", "solved", " ", "for",
          " ", "deltaSolution"}]}], ",", " ", 
       RowBox[{
       "then", " ", "deltaSolution", " ", "is", " ", "added", " ", "to", " ", 
        "solution"}], ",", " ", 
       RowBox[{"the", " ", "new", " ", "error", " ", "function", " ", "error", 
        RowBox[{"(", "solution", ")"}], " ", "is", " ", "computed"}], ",", 
       " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"olderr", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<The initial error is set to \>\"", ",", " ", "olderr", ",", 
       "\"\< by default.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"relError", ">", "solutionPrecision"}], " ", "&&", 
        RowBox[{"iterCount", "<", 
         RowBox[{"iterMax", "+", "1"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<*************************************************\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Starting iteration number \>\"", ",", "iterCount"}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Jacobi", " ", "matrix", " ", "jac", " ", "will", " ", "be", " ", 
          "constructed", " ", "in", " ", "groups", " ", "of", " ", "n", " ", 
          "rows"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacPosition", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"nInitial", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "6"}], "}"}], ",", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"nInitial", "+", "1"}], ",", 
               RowBox[{"nInitial", "+", "nStatic"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "nTotal"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jacValue", " ", "=", 
         RowBox[{"If", "[", 
          RowBox[{"existStaticEq", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"1", ",", " ", 
               RowBox[{"{", "nInitial", "}"}]}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"Apply", "[", 
                 RowBox[{"fSTAT", ",", "lower"}], "]"}], ",", 
                RowBox[{"{", "lower", "}"}]}], "]"}], "/.", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"Thread", "[", 
                 RowBox[{"lower", "\[Rule]", 
                  RowBox[{"solution", "[", 
                   RowBox[{"[", 
                    RowBox[{"Range", "[", "nTotal", "]"}], "]"}], "]"}]}], 
                 "]"}], "}"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", " ", 
             RowBox[{"{", "nInitial", "}"}]}], "]"}]}], "\[IndentingNewLine]",
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Filling in the main blocks of the Jacobian...\>\"",
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", "meshPoints"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"jacPosition", " ", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"jacPosition", ",", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", "k"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"nInitial", "+", "nStatic", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
                   "1"}], ",", 
                  RowBox[{"nInitial", "+", "nStatic", "+", 
                   RowBox[{"i", "*", "nTotal"}]}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
                   "1"}], ",", 
                  RowBox[{"i", "*", "nTotal"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"jacValue", " ", "=", " ", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"jacValue", ",", " ", 
              RowBox[{"jacLeft", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Thread", "[", 
                   RowBox[{"lower", "\[Rule]", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"nTotal", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"nTotal", "*", "i"}]}], "]"}], "]"}], "]"}]}], 
                   "]"}], ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"upper", "\[Rule]", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "nTotal"}]}], "]"}], 
                    "]"}], "]"}]}], "]"}], ",", " ", 
                  RowBox[{"tau", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                    ")"}]}], ",", 
                  RowBox[{"time", "\[Rule]", 
                   RowBox[{"timeFunc", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                    "]"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"jacPosition", " ", "=", " ", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"jacPosition", ",", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", "k"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"nInitial", "+", "nStatic", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "nTotal"}], "+", 
                   "1"}], ",", 
                  RowBox[{"nInitial", "+", "nStatic", "+", 
                   RowBox[{"i", "*", "nTotal"}]}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{
                   RowBox[{"i", "*", "nTotal"}], "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}], "*", "nTotal"}]}], 
                 "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"jacValue", " ", "=", " ", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"jacValue", ",", " ", 
              RowBox[{"jacRight", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Thread", "[", 
                   RowBox[{"lower", "\[Rule]", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"nTotal", "-", "1"}], ")"}]}], ",", 
                    RowBox[{"nTotal", "*", "i"}]}], "]"}], "]"}], "]"}]}], 
                   "]"}], ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"upper", "\[Rule]", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "nTotal"}]}], "]"}], 
                    "]"}], "]"}]}], "]"}], ",", " ", 
                  RowBox[{"tau", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                    ")"}]}], ",", 
                  RowBox[{"time", "\[Rule]", 
                   RowBox[{"timeFunc", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                    "]"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"end", " ", "of", " ", "for", " ", "loop"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"jacPosition", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"jacPosition", ",", " ", 
           RowBox[{"jacFinal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jacValue", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"jacValue", ",", " ", 
           RowBox[{"jacFinal", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"jac", " ", "=", " ", 
         RowBox[{"SparseArray", "[", 
          RowBox[{"Rule", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "jacPosition", "]"}], ",", "2"}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"N", "[", 
             RowBox[{"Flatten", "[", "jacValue", "]"}], "]"}]}], "]"}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Successful generation of the numerical Jacobian...\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AllTrue", "[", 
           RowBox[{"jac", ",", "NumericQ"}], "]"}], ",", 
          RowBox[{
          "Print", "[", "\"\<All elements of jac are numerical.\>\"", "]"}], 
          ",", 
          RowBox[{
          "Print", "[", "\"\<Some non-numeric element exists.\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"solving", "  ", "jac", 
           RowBox[{"(", "solution", ")"}], " ", "*", " ", "deltaSolution"}], 
          " ", "=", " ", 
          RowBox[{
           RowBox[{"-", "error"}], 
           RowBox[{"(", "solution", ")"}], "  ", "for", " ", 
           "deltaSolution"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"deltaSolution", " ", "=", " ", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{
           RowBox[{"N", "[", "jac", "]"}], ",", 
           RowBox[{"N", "[", 
            RowBox[{"-", "error"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"deltaSolution", "=", 
           RowBox[{
            RowBox[{"Inverse", "[", "jac", "]"}], ".", 
            RowBox[{"(", 
             RowBox[{"-", "error"}], ")"}]}]}], ";"}], " ", "*)"}], 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Works", " ", "faster"}], ",", " ", 
          RowBox[{
           RowBox[{
           "but", " ", "can", " ", "lead", " ", "to", " ", "large", " ", 
            "errors", " ", "for", " ", "ill"}], "-", 
           RowBox[{"conditioned", " ", 
            RowBox[{"matrices", "."}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"updating", " ", "solution", " ", "and", " ", "error"}], 
           ";", " ", 
           RowBox[{
           "as", " ", "nonpositive", " ", "values", " ", "for", " ", 
            "solution", " ", "can", " ", "cause", " ", "problems", " ", 
            "with", " ", "Jacobi", " ", "matrix"}]}], ",", " ", 
          RowBox[{"they", " ", "are", " ", "set", " ", "to", " ", 
           RowBox[{"minSolutionValue", "."}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"solution", " ", "=", " ", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Max", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"solution", "+", "deltaSolution"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"minSolutionValue", ",", 
                 RowBox[{"{", 
                  RowBox[{"nTotal", "*", "meshPoints"}], "}"}]}], "]"}]}], 
              "}"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"err", "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"meshPoints", "*", "nTotal"}]], "*", 
          RowBox[{"Total", "[", 
           RowBox[{"Abs", "[", "deltaSolution", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"solution", "=", 
         RowBox[{"solution", "+", "deltaSolution"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"error", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{"existStaticEq", ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", "nInitial", "]"}], "]"}], "]"}], "-", 
               RowBox[{"initialValues", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", "nInitial", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"Apply", "[", 
               RowBox[{"fSTAT", ",", 
                RowBox[{"solution", "[", 
                 RowBox[{"[", 
                  RowBox[{"Range", "[", "nTotal", "]"}], "]"}], "]"}]}], 
               "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    "-", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"nTotal", "-", "nStatic"}]}], "}"}]}], "]"}], "-", 
                   RowBox[{"deltaTau", "*", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"fODE", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "nTotal"}], "}"}]}], "]"}]}], 
                    "]"}], " ", "*", "  ", 
                    RowBox[{"timeFuncDerivat", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                    "]"}]}]}], ",", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"fSTAT", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "nTotal"}], "}"}]}], "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"meshPoints", "-", "1"}]}], "}"}]}], "]"}], ",", 
              "errorFinal"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", 
                  RowBox[{"nInitial", "-", "1"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"initialValues", "[", 
                RowBox[{"[", 
                 RowBox[{"Range", "[", 
                  RowBox[{"nInitial", "-", "1"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"[", "6", "]"}], "]"}], "-", 
               RowBox[{"initialValues", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    "-", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"nTotal", "-", "nStatic"}]}], "}"}]}], "]"}], "-", 
                   RowBox[{"deltaTau", "*", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"fODE", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "+", "j"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nTotal", "*", "i"}], "-", "nTotal", "+", "j"}], 
                    "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "nTotal"}], "}"}]}], "]"}]}], 
                    "]"}], " ", "*", " ", 
                    FractionBox["1", 
                    RowBox[{"invtimeFuncDerivat", "[", "time", "]"}]]}]}], 
                  " ", "}"}], "/.", 
                 RowBox[{"time", "\[Rule]", 
                  RowBox[{"timeFunc", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "deltaTau"}], " ", 
                    "+", " ", 
                    RowBox[{"i", "*", "deltaTau"}]}], ")"}], "/", "2"}], 
                   "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"meshPoints", "-", "1"}]}], "}"}]}], "]"}], ",", 
              "errorFinal"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Working... Just finished iteration \>\"", ",", " ", "iterCount",
           ",", " ", "\"\< with a total error of \>\"", ",", " ", "err", ",", 
          "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<For iterations number \>\"", ",", 
          RowBox[{"iterCount", "-", "1"}], ",", "\"\< and \>\"", ",", 
          "iterCount", ",", 
          "\"\<, the relative error \!\(\*FractionBox[\(\(\\\ \
\)\*SubscriptBox[\(err\), \(iterCount\)]\), SubscriptBox[\(err\), \(iterCount \
- 1\)]]\) is \>\"", ",", " ", 
          FractionBox["err", "olderr"], " ", ",", "\"\<.\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Time elapsed: \>\"", ",", " ", 
          RowBox[{"tComputation", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<*************************************************\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"olderr", "=", "err"}], ";", "\[IndentingNewLine]", 
        RowBox[{"relError", "=", "err"}], ";", "\[IndentingNewLine]", 
        RowBox[{"iterCount", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "of", " ", "while", " ", "loop"}], " ", "*)"}], 
     "\n", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Construction", " ", "of", " ", "the", " ", "solution", " ", 
        "matrix"}], ",", " ", 
       RowBox[{"columns", " ", "ordered", " ", "by", 
        RowBox[{"(", 
         RowBox[{"time", ",", 
          RowBox[{
           RowBox[{"<<", "variableNames"}], ">>"}]}], ")"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"solution", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{"solution", ",", "nTotal"}], "]"}], "]"}], ",", 
         "timeList"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solutionReduced", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"solution", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "timeMax"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Construction", " ", "of", " ", "the", " ", "iteration", " ", "log", 
       " ", 
       RowBox[{"matrix", ":", " ", 
        RowBox[{"<", 
         RowBox[{"iteration", " ", "number"}], ">", " ", "<", 
         RowBox[{"mean", " ", 
          RowBox[{"rel", ".", " ", "error"}]}], ">", " ", "<", 
         RowBox[{"max", ".", " ", "rel", ".", " ", "error"}], ">"}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"iterationLogList", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"iterCount", "-", "1"}], "]"}], ",", "meanRelErrorList", 
         ",", "maxRelErrorList"}], "}"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.39239387375*^9, {3.39239751584375*^9, 3.39239751715625*^9}, {
   3.795797046362628*^9, 3.7957971353787193`*^9}, {3.795866425443589*^9, 
   3.7958664302258015`*^9}, {3.795866584035118*^9, 3.7958668422538877`*^9}, {
   3.7958669695831704`*^9, 3.7958670003569307`*^9}, {3.7958670726860676`*^9, 
   3.7958670792234416`*^9}, {3.795867111448285*^9, 3.7958671168115916`*^9}, {
   3.7959315743410635`*^9, 3.795931591128024*^9}, {3.7959527019829364`*^9, 
   3.7959527119845085`*^9}, {3.7959527696648073`*^9, 
   3.7959527770152283`*^9}, {3.7959532161683464`*^9, 
   3.7959532250908566`*^9}, {3.796646681997702*^9, 3.7966467163946695`*^9}, {
   3.796647273970561*^9, 3.7966473936904087`*^9}, {3.796663559182482*^9, 
   3.796663560987585*^9}, {3.796664273337329*^9, 3.7966642792906694`*^9}, {
   3.7966644760959263`*^9, 3.796664479554124*^9}, {3.7966645836700788`*^9, 
   3.796664611122649*^9}, {3.796665287773351*^9, 3.7966653138778443`*^9}, {
   3.7967252803115706`*^9, 3.796725296982524*^9}, {3.7967254177474318`*^9, 
   3.7967254301851425`*^9}, {3.7967256406281796`*^9, 
   3.7967256426212935`*^9}, {3.7981707743692856`*^9, 
   3.7981708638334026`*^9}, {3.7981711295115986`*^9, 
   3.7981711417372975`*^9}, {3.7981712094281693`*^9, 3.798171214584464*^9}, {
   3.7981833369451933`*^9, 3.798183357637377*^9}, {3.7982715557989483`*^9, 
   3.798271563234373*^9}, {3.79828918966306*^9, 3.7982892082941256`*^9}, {
   3.798315255116137*^9, 3.798315426715952*^9}, {3.80122220286904*^9, 
   3.8012222649965935`*^9}, {3.8012223048068705`*^9, 
   3.8012224176303234`*^9}, {3.801222606807144*^9, 3.8012226132665133`*^9}, {
   3.8012228323180428`*^9, 3.801222893104519*^9}, {3.801222962611495*^9, 
   3.8012231338452888`*^9}, {3.8012231652930875`*^9, 
   3.8012232408234076`*^9}, {3.8012291900596848`*^9, 3.801229241682637*^9}, {
   3.8012292758695927`*^9, 3.8012292940376315`*^9}, {3.8012359821877255`*^9, 
   3.8012359858329344`*^9}, {3.801551041265525*^9, 3.801551052999196*^9}, {
   3.8032053416830864`*^9, 3.803205354923844*^9}, {3.803219402746333*^9, 
   3.8032194583865156`*^9}, 3.8032195064012623`*^9, {3.803231431185089*^9, 
   3.803231435059311*^9}, {3.804325231286502*^9, 3.8043252469813995`*^9}, {
   3.8043254004871798`*^9, 3.8043254326160173`*^9}, {3.8043260608169484`*^9, 
   3.804326304655895*^9}, {3.8043449967480216`*^9, 3.804345029356887*^9}, {
   3.8043493433546333`*^9, 3.804349346629821*^9}, {3.805015253121587*^9, 
   3.8050153356383066`*^9}, {3.8050153681451654`*^9, 3.80501538464911*^9}, {
   3.8050154369751024`*^9, 3.8050155505275974`*^9}, {3.8050159654613304`*^9, 
   3.8050160150861683`*^9}, {3.80501672232062*^9, 3.8050167279209404`*^9}, 
   3.805016883950865*^9, {3.8050277135272813`*^9, 3.805027720723693*^9}, {
   3.8050277567817554`*^9, 3.8050277899146504`*^9}, {3.805031906421101*^9, 
   3.805031923383071*^9}, {3.8050320826991835`*^9, 3.805032082971199*^9}, {
   3.8050321164101114`*^9, 3.8050321798837423`*^9}, {3.8050323110582447`*^9, 
   3.805032342182025*^9}, {3.805032452016307*^9, 3.8050325097166076`*^9}, {
   3.8050328130569572`*^9, 3.8050328355672455`*^9}, {3.805033549917104*^9, 
   3.8050335733254423`*^9}, {3.8050350114016953`*^9, 
   3.8050350184981017`*^9}, {3.805374948514183*^9, 3.8053749710250225`*^9}, {
   3.805514291836827*^9, 3.805514307078655*^9}, {3.810208305159481*^9, 
   3.810208336313736*^9}, {3.8102087038703823`*^9, 3.810208704884384*^9}, {
   3.810541088572418*^9, 3.810541152768618*^9}, {3.810541254037875*^9, 
   3.8105412772582035`*^9}, {3.810541604911944*^9, 3.8105416470193524`*^9}, {
   3.810541687154648*^9, 3.810541701898491*^9}, {3.810541783044132*^9, 
   3.8105417851222515`*^9}, {3.8105419622163806`*^9, 3.810541985691723*^9}, {
   3.8159233161028314`*^9, 3.815923355628092*^9}, {3.8159970882628126`*^9, 
   3.8159970975873456`*^9}, {3.8159971544906006`*^9, 3.815997154636609*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"a9d7dbba-25c0-412b-8b63-18297d12ad73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output", "Section",ExpressionUUID->"726f8d3c-4fc5-4b77-b365-dcdb0b1ce106"],

Cell[CellGroupData[{

Cell["Bookkeeping information", "Subsection",
 CellChangeTimes->{{3.793914373011644*^9, 
  3.793914374627736*^9}},ExpressionUUID->"65f6252c-0877-4ed2-92ba-\
a7443ec002c2"],

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Computation time, without input processing and output generation: \
\>\"", ",", " ", 
   RowBox[{"tComputation", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Criterium for definitve solution: \>\"", ",", "\n", "\t", 
    "errorCondFunc", ",", " ", "\"\< relative error < \>\"", ",", " ", 
    "solutionPrecision", ",", " ", "\"\< = solutionPrecision\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of iterations needed: \>\"", ",", 
    RowBox[{"iterCount", "-", "1"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  "\"\<iteration log (iteration number, mean relative error, maximal relative \
error):\>\"", "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"iterationLogList", " ", "//", " ", "TableForm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8159229362271037`*^9, 3.8159229427074747`*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"e97aba38-8e3d-4e20-aa96-cfb812fdb96b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The solution in table form", "Subsection",ExpressionUUID->"a40c2cde-ed9a-49c7-b01e-67fe6990d282"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Solution \>\"", ",", " ", "variableNames", ",", " ", "\"\<:\>\""}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"solution", "//", "TableForm"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8014946671404743`*^9, 3.801494667306405*^9}, {
  3.804397109090972*^9, 3.804397121253668*^9}, {3.805031577172269*^9, 
  3.805031611619239*^9}, {3.8182474581469316`*^9, 
  3.818247462109226*^9}},ExpressionUUID->"79df05b8-8495-4118-8324-\
609437d674ef"]
}, Open  ]],

Cell["The graphs", "Subsection",ExpressionUUID->"e63364b9-80f4-4a8a-88fd-ffe3b66445f5"],

Cell[CellGroupData[{

Cell["plot settings", "Subsection",ExpressionUUID->"2f4b188b-4318-4f89-9e56-583c96dce3f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"graphs", " ", "to", " ", "plot"}], ";", " ", 
     RowBox[{
     "numbers", " ", "have", " ", "the", " ", "same", " ", "order", " ", "as",
       " ", "in", " ", "the", " ", "ODEs"}]}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "1"}], " ", "=", " ", "time"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"plotIndex", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], ";"}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", "f"}], ")"}], ",", " ", 
    RowBox[{"(", 
     RowBox[{"t", ",", "u"}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{"t", ",", "h"}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{"t", ",", "v"}], ")"}], ",", " ", 
    RowBox[{"(", 
     RowBox[{"f", ",", "h"}], ")"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.791087216529429*^9, 3.7910872304170713`*^9}, {
   3.7939098484038515`*^9, 3.7939098685790052`*^9}, {3.7945756806021347`*^9, 
   3.794575684157338*^9}, 3.7945763295562525`*^9, {3.798170713697815*^9, 
   3.798170724664442*^9}, {3.7981832322432046`*^9, 3.798183233083253*^9}, {
   3.799612095922234*^9, 3.79961210494475*^9}, {3.8182474753099937`*^9, 
   3.818247480778429*^9}},ExpressionUUID->"2c8969a9-e998-409f-af0e-\
0da83d39b83e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", 
      RowBox[{
       RowBox[{"Length", "[", "plotIndex", "]"}], "+", "1"}]}], ",", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"solutionReduced", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"plotIndex", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"plotIndex", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "timeMax"}], "}"}], ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "All"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"variableNames", "[", 
            RowBox[{"[", 
             RowBox[{"plotIndex", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"variableNames", "[", 
            RowBox[{"[", 
             RowBox[{"plotIndex", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], 
          "}"}]}]}], "]"}], "]"}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"solutionReduced", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"plotIndex", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"solutionReduced", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"plotIndex", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"solutionReduced", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"plotIndex", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "timeMax"}], "}"}], ",", "All"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<f\>\"", ",", "\"\<h\>\"", ",", "\"\<\[Phi]\>\""}], 
       "}"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.39239389825*^9, 3.392393919*^9}, {3.801225475595229*^9, 
  3.801225486990881*^9}, {3.801503056651511*^9, 3.801503063679729*^9}, {
  3.801503095620916*^9, 3.801503167832296*^9}, {3.8015515151816316`*^9, 
  3.801551547123459*^9}, {3.81824748820131*^9, 
  3.818247492502017*^9}},ExpressionUUID->"faed5a0a-b3af-42e9-ad98-\
e5cde78a714b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting the data", "Subsection",
 CellChangeTimes->{{3.8041840308003106`*^9, 
  3.804184036172618*^9}},ExpressionUUID->"82106ae2-e064-4a6a-9af8-\
8e2b5c941394"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dat", "=", 
    RowBox[{"solution", "//", "TableForm"}]}], ";", "\n", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<newsolution.dat\>\"", ",", "dat"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8041840445120945`*^9, 3.8041840744128056`*^9}, {
  3.8041841256617365`*^9, 3.8041841454738693`*^9}, {3.818247511501129*^9, 
  3.818247521019826*^9}},ExpressionUUID->"3807d119-83ef-43d7-b753-\
43e48cf75d63"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cleaning up", "Subsection",ExpressionUUID->"afe12438-71cd-4643-a39d-9870787159c5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.801494249119609*^9, 3.801494250558305*^9}, {
  3.80149537131887*^9, 3.801495373924885*^9}, {3.801501181286808*^9, 
  3.801501182888391*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"79694c03-00d9-4e30-9e66-3372dc8a901e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis of the data - integration of the energy functional", \
"Subsection",
 CellChangeTimes->{{3.8102962324609146`*^9, 
  3.810296253385112*^9}},ExpressionUUID->"4e36ba48-b711-4d4d-ae1b-\
a0cb3177a976"],

Cell["\<\
First, the data is stored in a separate table, solutionshortened, which takes \
away the last value (since it is assigned to the radial value \
\[OpenCurlyDoubleQuote]Infinity\[CloseCurlyDoubleQuote], which is \
non-numerical and cannot be processed). These data are then stored in \
solutiondata.\
\>", "Text",
 CellChangeTimes->{{3.810296273499262*^9, 3.8102962877890797`*^9}, {
  3.8102978237739325`*^9, 
  3.8102978750658665`*^9}},ExpressionUUID->"d5f24541-74cd-43d3-9af5-\
3e64f1e91bcc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solutionshortened", "=", 
   RowBox[{"solution", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"Length", "[", "solution", "]"}], "-", "1"}]}], "]"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"solutiondata", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"solutionshortened", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "7"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "list", " ", "of", " ", "lists", " ", "with", " ", "the", " ", "mesh", " ",
     "point", " ", "values", " ", "for", " ", 
    RowBox[{"{", 
     RowBox[{"f", ",", "h", ",", "p", ",", "fdot", ",", "hdot", ",", "pdot"}],
      "}"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.810297710073429*^9, 3.810297739740126*^9}, 
   3.8102978855534663`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"786a4436-1875-443d-91d4-096c5671f4ff"],

Cell["\<\
The data are interpolated with polynomials of up to order five. It is \
certainly arbitrary, but it is only supposed to provide a means of \
comparison. The user can choose to take higher order polynomials or just use \
the results for any interpolation order used here.\
\>", "Text",
 CellChangeTimes->{{3.8102963241321583`*^9, 
  3.8102964323433475`*^9}},ExpressionUUID->"880a1b00-4e69-4f76-84f9-\
c0c832243510"],

Cell[BoxData[
 RowBox[{
  RowBox[{"max\[TripleDot]interpolation\[TripleDot]order", "=", "1"}], ";", 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{"HAVE", " ", "DECREASED", " ", "FROM", " ", "5", " ", "to", " ", 
    RowBox[{"2", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListInterpolation", "[", 
        RowBox[{
         RowBox[{"solutionshortened", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"solutionshortened", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "i"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "7"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "i", ",", "1", ",", "max\[TripleDot]interpolation\[TripleDot]order"}], 
      "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "list", " ", "of", " ", "lists", " ", "of", " ", "interpolating", " ", 
    "functions", " ", "with", " ", "splins", " ", "of", " ", "order", " ", 
    RowBox[{"j", ":", " ", 
     RowBox[{
     "there", " ", "are", " ", 
      "max\[TripleDot]interpolation\[TripleDot]order", " ", "lists", " ", 
      "with", " ", "interpolating", " ", "functions", " ", "of", " ", "order",
       " ", "i", " ", "arranged", " ", "like", " ", 
      RowBox[{"{", 
       RowBox[{
       "f", ",", "h", ",", "p", ",", "fdot", ",", "hdot", ",", "pdot"}], 
       "}"}]}]}]}], "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.801761425600439*^9, 3.80176145655521*^9}, {
  3.8017615438102007`*^9, 3.8017615612721996`*^9}, {3.80176162160865*^9, 
  3.80176173750828*^9}, {3.801761771865245*^9, 3.8017619761759305`*^9}, {
  3.8017620301970205`*^9, 3.8017620336422176`*^9}, {3.801762489320281*^9, 
  3.801762522644187*^9}, {3.8102981787072334`*^9, 3.8102981825284524`*^9}, {
  3.8102985545427303`*^9, 3.8102985722417426`*^9}, {3.8102986094318695`*^9, 
  3.8102986165642776`*^9}, {3.819120935474725*^9, 3.8191209504664707`*^9}, {
  3.819121027366476*^9, 3.819121038425815*^9}, {3.823356720983593*^9, 
  3.823356721080812*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"312d5ea0-ea08-4504-90e6-8034acbf52bb"],

Cell["\<\
The following block defines the energy functional as a function of the \
right-hand side limit y; i is the order of integration of the interpolation \
polynomials being integrated\
\>", "Text",
 CellChangeTimes->{{3.8102965129939604`*^9, 
  3.810296629506624*^9}},ExpressionUUID->"3973cdc3-0e5e-4f52-8a51-\
7d71191749a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"i", ",", "z", ",", "y"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.824059234815576*^9, 
  3.824059240213677*^9}},ExpressionUUID->"f3942ca4-6f07-407c-b751-\
ad7499b62e85"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"integralfunction", "[", 
    RowBox[{"i_", ",", "z_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"4", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}], "[", "z", "]"}], ")"}], 
        "2"]}], "+", 
      RowBox[{
       FractionBox["8", 
        SuperscriptBox["z", "2"]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "z", "]"}], ")"}], 
        "2"], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "z", "]"}]}], ")"}], 
        "2"]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["z", "2"], "2"], "*", 
       FractionBox[
        SuperscriptBox["finiteTv", "2"], 
        SuperscriptBox["finiteT\[CapitalOmega]", "2"]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "5"}], "]"}], "]"}], "[", "z", "]"}], ")"}], 
        "2"]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["finiteTv", "2"], 
        SuperscriptBox["finiteT\[CapitalOmega]", "2"]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "z", "]"}], ")"}], 
        "2"], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "z", "]"}]}], ")"}], 
        "2"]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["z", "2"], "2"], "*", 
       FractionBox[
        SuperscriptBox["finiteTx", "2"], 
        SuperscriptBox["finiteT\[CapitalOmega]", "2"]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "6"}], "]"}], "]"}], "[", "z", "]"}], ")"}], 
        "2"]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["z", "2"], 
        RowBox[{
         SuperscriptBox["g", "2"], "*", 
         SuperscriptBox["finiteT\[CapitalOmega]", "4"]}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"potential", "[", 
             RowBox[{"temp", ",", 
              RowBox[{"finiteTv", "*", 
               RowBox[{
                RowBox[{
                "interpolating\[TripleDot]function\[TripleDot]list", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "z", "]"}]}], 
              ",", 
              RowBox[{"finiteTx", "*", 
               RowBox[{
                RowBox[{
                "interpolating\[TripleDot]function\[TripleDot]list", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "[", "z", "]"}]}]}], 
             "]"}], "/.", "Params"}], "/.", "dParams"}], ")"}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"potential", "[", 
             RowBox[{"temp", ",", "finiteTv", ",", "finiteTx"}], "]"}], "/.", 
            "Params"}], "/.", "dParams"}], ")"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0.00001", ",", "y"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8017649114948215`*^9, 3.8017650025870314`*^9}, 
   3.8017655487512703`*^9, 3.810298878547262*^9, {3.810299456888342*^9, 
   3.8102995204019747`*^9}, {3.810300394766985*^9, 3.8103003994432526`*^9}, {
   3.816016855894456*^9, 3.816016876837654*^9}, {3.8160198358458996`*^9, 
   3.8160198456154585`*^9}, {3.8160203534295034`*^9, 3.816020355154602*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"f6881afe-91a1-4ff2-9715-2ab84416bf0c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"integralfunction", "[", 
   RowBox[{"1", ",", "z", ",", "10"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8160203632300644`*^9, 3.8160204035813723`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"1acd4ee0-0093-4dd8-8ef7-b41b111c5894"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"i", ",", "z"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.824059251194457*^9, 
  3.8240592567140017`*^9}},ExpressionUUID->"39e86309-035a-4a8e-b082-\
d483f225bc93"],

Cell[BoxData[
 RowBox[{"sphaleron\[TripleDot]energies", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"integralfunction", "[", 
     RowBox[{"i", ",", "z", ",", 
      RowBox[{"Max", "[", 
       RowBox[{"solutiondata", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "i", ",", "1", ",", "max\[TripleDot]interpolation\[TripleDot]order"}], 
     "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "T"}], "=", "120"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.810303892394038*^9, 3.810303898939412*^9}, {
  3.810320008317816*^9, 3.810320008512827*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"ecced01a-36e8-4ee3-87b5-e84736459fa5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "[", "solutiondata", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8103200340292864`*^9, 3.8103200370024567`*^9}, {
  3.816026385143498*^9, 3.8160263879666595`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"1231f56f-fb78-40d1-96d4-5d00e6fcabcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Do", " ", "not", " ", "change", " ", 
    RowBox[{"this", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solutiondataOld", "=", "solutiondata"}], ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.8103009689698277`*^9, 3.8103010125043173`*^9}, {
  3.810305978375349*^9, 3.8103059816125345`*^9}, {3.8103200173123302`*^9, 
  3.810320019496455*^9}, {3.8103219721301394`*^9, 3.8103219753873262`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"383a13aa-3269-4c84-8475-38ced108af13"],

Cell[BoxData[{
 RowBox[{"listplots", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"solutiondata", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"solutiondata", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"solutiondata", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "0.05"}]}], "}"}]}],
         "}"}]}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"SwatchLegend", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Gauge field\>\"", "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
         RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}], 
      ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Xi]\>\"", ",", " ", "\"\<Field value\>\""}], "}"}]}], 
      ",", 
      RowBox[{"PlotLabel", "\[Rule]", "\"\<Plots of f, h and s\>\""}]}], 
     "]"}], ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"solutiondata", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"solutiondata", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"solutiondata", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "0.05"}]}], "}"}]}],
         "}"}]}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"SwatchLegend", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Higgs field\>\"", "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
         RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}], 
     "]"}], ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"solutiondata", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"solutiondata", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"solutiondata", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "0.05"}]}], "}"}]}],
         "}"}]}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"SwatchLegend", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Singlet field\>\"", "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
         RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"solutiondata", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solutiondata", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Gauge field, 0 GeV\>\"", "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
          RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Xi]\>\"", ",", " ", "\"\<Field value\>\""}], "}"}]}], 
       ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Comparison of the three fields at 0 GeV and 120.21 GeV\>\""}]}], 
      "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"solutiondataOld", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solutiondataOld", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Orange"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Gauge field, 120.21 GeV\>\"", "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
          RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"{", "\"\<Orange: Gauge field, finite T\>\"", "}"}], "*)"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"solutiondata", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solutiondata", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Higgs field, 0 GeV\>\"", "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
          RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"solutiondataOld", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solutiondataOld", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Cyan"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Higgs field, 120.21 GeV\>\"", "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
          RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}],
       "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"solutiondata", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solutiondata", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Singlet field, 0 GeV\>\"", "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
          RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}],
       "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"solutiondataOld", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solutiondataOld", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", "All"}], "}"}]}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Tiny"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Yellow"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Singlet field, 120.21 GeV\>\"", "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "10"}], ",", 
          RowBox[{"LegendMarkers", "\[Rule]", "\"\<Bubble\>\""}]}], "]"}]}]}],
       "]"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8103059911710815`*^9, 3.8103060812732344`*^9}, {
  3.8103062359480815`*^9, 3.8103063041879845`*^9}, {3.8103064256979346`*^9, 
  3.810306533015073*^9}, {3.816026628631425*^9, 3.8160266971103415`*^9}, {
  3.816026775116803*^9, 3.8160268408275614`*^9}, {3.8160268776176662`*^9, 
  3.8160269314267435`*^9}, {3.8160273698198185`*^9, 3.816027380564433*^9}, {
  3.8160711900360837`*^9, 3.816071196372446*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"3ead0ed2-e28f-4782-bd9b-6c206f6df93d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Energies", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"4", "*", "\[Pi]", "*", "finiteT\[CapitalOmega]"}], "g"], "*", 
    "sphaleron\[TripleDot]energies"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.816075040331308*^9, 3.816075066521806*^9}, {
  3.81823193340641*^9, 3.818231946389369*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"d35589b1-4db1-43e6-b710-e42f422b6fe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"i", ",", "z", ",", "y", ",", "\[Eta]"}], "]"}], ";"}]], "Input",Ex\
pressionUUID->"0ae7a97e-2c59-42e1-959f-8014f36125cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pfunc", "[", 
   RowBox[{
    RowBox[{"i_", "?", "NumericQ"}], ",", 
    RowBox[{"z_", "?", "NumericQ"}], ",", 
    RowBox[{"y_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"pfunc", "[", 
    RowBox[{"i", ",", "z", ",", "y"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"3", "*", 
       SuperscriptBox["z", "3"]}]], "*", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Eta]", "2"], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "\[Eta]", "]"}], 
          ")"}], "2"], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "\[Eta]", "]"}]}], 
         ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Eta]", ",", "0.00001", ",", "z"}], "}"}]}], "]"}]}], "+", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"3", "*", "\[Eta]"}]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "\[Eta]", "]"}], 
         ")"}], "2"], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "\[Eta]", "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", "z", ",", "y"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.81607219248742*^9, 3.816072210989479*^9}, {
  3.816072248690635*^9, 3.8160723892936773`*^9}, {3.8160728308459325`*^9, 
  3.8160729372850204`*^9}, {3.8160739019761972`*^9, 3.8160739249155097`*^9}, {
  3.8160743115086217`*^9, 3.81607432757154*^9}, {3.816074458437025*^9, 
  3.8160744875656915`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"121f09c6-b117-4d55-b8b9-ecaf53d88fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"i", ",", "\[Chi]", ",", "y"}], "]"}], ";"}]], "Input",ExpressionUU\
ID->"30753ba2-09b1-4a0b-8dc3-6c5c63f1ee4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WeinbergTheta", "=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"80.38", "/", "91.19"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ecorrection", "[", 
   RowBox[{"i_", ",", "\[Chi]_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Chi]", "2"], "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "\[Chi]", "]"}], ")"}], 
      "2"], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"interpolating\[TripleDot]function\[TripleDot]list", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "\[Chi]", "]"}]}], 
      ")"}], "*", 
     RowBox[{"pfunc", "[", 
      RowBox[{"i", ",", "\[Chi]", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Chi]", ",", "0.00001", ",", "y"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.816072987335883*^9, 3.816073056675849*^9}, {
   3.8160731256017914`*^9, 3.816073339279013*^9}, 3.816074144008041*^9, {
   3.816074234444214*^9, 3.816074243587737*^9}, {3.8160743307897243`*^9, 
   3.816074338593171*^9}, {3.8160745097699614`*^9, 3.8160745154202843`*^9}, {
   3.816074569521379*^9, 3.8160745697413917`*^9}, {3.8160746493959475`*^9, 
   3.8160747137526283`*^9}, {3.8160747681027374`*^9, 3.816074849172374*^9}, {
   3.8160749159621944`*^9, 3.8160749610937757`*^9}, {3.8160751092712507`*^9, 
   3.8160751106583304`*^9}, {3.824059155095714*^9, 3.824059161354104*^9}, {
   3.8240595878951406`*^9, 
   3.824059588174658*^9}},ExpressionUUID->"66527279-fb19-4822-bb16-\
a055ae4a4722"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"i", ",", "r", ",", "y"}], "]"}], ";"}]], "Input",ExpressionUUID->\
"25541f34-225f-4d7f-b45f-ed563fa17fe3"],

Cell[BoxData[
 RowBox[{"corrections", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "3"]}], "*", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"g", "*", 
        RowBox[{"Tan", "[", "WeinbergTheta", "]"}]}], ")"}], "2"], "*", 
     "finiteTv"}], 
    SuperscriptBox["g", "3"]], "*", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Ecorrection", "[", 
      RowBox[{"i", ",", "r", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"solutiondata", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "i", ",", "1", ",", "max\[TripleDot]interpolation\[TripleDot]order"}], 
      "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.816073359360162*^9, 3.816073364308445*^9}, {
  3.816073428267103*^9, 3.816073428357108*^9}, {3.8160740780802703`*^9, 
  3.816074078170275*^9}, {3.816074250915156*^9, 3.816074251057164*^9}, {
  3.816074427887278*^9, 3.8160744284993134`*^9}, {3.8160745902465644`*^9, 
  3.816074590485578*^9}, {3.816074720813032*^9, 3.8160747209030375`*^9}, {
  3.816075135902774*^9, 3.81607520261759*^9}, {3.8160752357844872`*^9, 
  3.816075237489585*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"614008a9-7dcd-4eb4-b86c-b0c06aa5b6b2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"??", 
   RowBox[{"??", "?"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.816073462565065*^9, 3.8160734859724035`*^9}, {
  3.816073943160553*^9, 3.8160739460957212`*^9}, {3.816074151264456*^9, 
  3.8160741532135677`*^9}, {3.816074304079197*^9, 3.8160743050192504`*^9}, {
  3.8160744542267847`*^9, 3.8160744551308365`*^9}, {3.81824761560367*^9, 
  3.8182476196003447`*^9}, {3.8240589462742023`*^9, 
  3.824058948693891*^9}},ExpressionUUID->"9e121602-01d8-4d46-ac17-\
fc630ace6e1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"linked", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"linked`maxai", "=", 
       RowBox[{"(*", 
        RowBox[{"{", 
         RowBox[{"V", ",", "W", ",", "Hder", ",", "Sder"}], "}"}], "*)"}], 
       "Energies"}], ",", 
      RowBox[{"linked`masai", "=", "corrections"}], ",", " ", 
      RowBox[{"linked`makay", "=", "listplots"}], ",", 
      RowBox[{"linked`SingletM", "=", "singletmass"}], ",", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "pfunc", ",", "Ecorrection", ",", "corrections", ",", 
        "interpolating\[TripleDot]function\[TripleDot]list", ",", "muHSquare",
         ",", "muSSquare"}], "]"}]}], "}"}]}], "]"}], ";", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"treepotential", "[", 
           RowBox[{"h", ",", "x"}], "]"}], "+", 
          RowBox[{"CWVpotentialwithGB", "[", 
           RowBox[{"h", ",", "x"}], "]"}], "+", 
          RowBox[{"Counterterms", "[", 
           RowBox[{"h", ",", "x"}], "]"}]}], ")"}], "/.", "Params"}], "/.", 
       "dParams"}], ",", 
      RowBox[{
       RowBox[{"treepotential", "[", 
        RowBox[{"h", ",", "x"}], "]"}], "/.", "Params"}], ",", 
      RowBox[{
       RowBox[{"CWVpotentialwithGB", "[", 
        RowBox[{"h", ",", "x"}], "]"}], "/.", "Params"}], ",", 
      RowBox[{
       RowBox[{"Counterterms", "[", 
        RowBox[{"h", ",", "x"}], "]"}], "/.", "dParams"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", 
      RowBox[{"-", "500"}], ",", "500"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<h [GeV]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(V\), \(T = 0\)]\)(h,s=x) \
[\!\(\*SuperscriptBox[\(GeV\), \(4\)]\)]\>\""}], "}"}]}], ",", 
    RowBox[{
    "PlotLabel", "\[Rule]", 
     "\"\<Zero-temperature potential at s=x as a function of h\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"potential0T", "[", 
         RowBox[{"100", ",", "h", ",", "x"}], "]"}], ")"}], "/.", "Params"}], 
      "/.", "dParams"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"potential", "[", 
         RowBox[{"100", ",", "h", ",", "x"}], "]"}], ")"}], "/.", "Params"}], 
      "/.", "dParams"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     RowBox[{"-", "500"}], ",", "500"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<h [GeV]\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[\(V\), \(T = 0\)]\)(h,s=x) \
[\!\(\*SuperscriptBox[\(GeV\), \(4\)]\)]\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Zero-temperature potential and potential at T at s=x as a function \
of h\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.815844568817315*^9, 3.815844568840316*^9}, {
   3.8158457500528774`*^9, 3.8158457622025723`*^9}, {3.8158458432062054`*^9, 
   3.815845845617344*^9}, {3.8158459175434575`*^9, 3.8158459595678616`*^9}, {
   3.815846243493101*^9, 3.815846265032333*^9}, {3.8158463005663652`*^9, 
   3.8158463015524216`*^9}, {3.8158999474602213`*^9, 3.8158999546806345`*^9}, 
   3.815900010242812*^9, {3.8159001876039567`*^9, 3.8159002016597605`*^9}, {
   3.8159005990274887`*^9, 3.815900610267132*^9}, {3.815900657172815*^9, 
   3.8159006794570894`*^9}, {3.815900766344059*^9, 3.815900778669764*^9}, {
   3.8159022847859087`*^9, 3.8159023602372246`*^9}, {3.8159082702502575`*^9, 
   3.8159082991389103`*^9}, {3.8159090745742626`*^9, 3.81590908938911*^9}, {
   3.8160209325906296`*^9, 3.816020937199894*^9}, {3.8160273558170176`*^9, 
   3.8160273993815093`*^9}, {3.8160752608829226`*^9, 
   3.8160752780749063`*^9}, {3.819012734427837*^9, 3.819012781430876*^9}, {
   3.8208435330369253`*^9, 3.820843559105545*^9}, {3.823356950854825*^9, 
   3.8233569728789873`*^9}, {3.824058916794421*^9, 
   3.824058917936511*^9}},ExpressionUUID->"db5aec5d-798c-48b6-a1d7-\
d9b378d49f48"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1386., 582.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3bccd07d-4dde-4745-b6eb-c75a2a361c80"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 169, 2, 29, "Input",ExpressionUUID->"e3f8dcf6-1e19-4642-ae7e-9f7e95e14283"],
Cell[730, 24, 386, 7, 29, "Input",ExpressionUUID->"ce1fa6ed-5482-4778-8218-a3b6aa517a05"],
Cell[1119, 33, 278, 5, 29, "Input",ExpressionUUID->"80b701c8-5fef-4658-8417-51f380dc3e67"],
Cell[CellGroupData[{
Cell[1422, 42, 210, 5, 45, "Subsubsection",ExpressionUUID->"005c8f89-f0db-439f-b767-5aa456a6ad0e"],
Cell[1635, 49, 592, 11, 58, "Text",ExpressionUUID->"d69475a1-58a8-4587-927f-5e441a061c96"],
Cell[2230, 62, 2098, 61, 87, "Input",ExpressionUUID->"0f3e5c72-fbeb-44d3-943e-11fa025e28dc",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4365, 128, 152, 3, 68, "Section",ExpressionUUID->"8200e51d-ad61-4d81-8173-d55539dffd4f"],
Cell[CellGroupData[{
Cell[4542, 135, 260, 5, 54, "Subsection",ExpressionUUID->"51c6f653-6300-48be-a61d-87ae8332922e"],
Cell[4805, 142, 1317, 20, 150, "Text",ExpressionUUID->"f5ebddf9-e65b-493b-9208-43e162055216"],
Cell[6125, 164, 1391, 37, 129, "Input",ExpressionUUID->"516e22b2-d068-4d4e-aaab-511a43350b92",
 InitializationCell->True],
Cell[7519, 203, 266, 7, 29, "Input",ExpressionUUID->"1b4e8f01-86f8-4573-868e-b26f937b951e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7822, 215, 217, 5, 54, "Subsection",ExpressionUUID->"92edfdc3-d4c2-41cd-bfd2-187b777610b8"],
Cell[8042, 222, 295, 7, 35, "Text",ExpressionUUID->"bf73d1e6-eed7-4ff8-998c-13a6b9e0ad2d"],
Cell[8340, 231, 5582, 138, 622, "Input",ExpressionUUID->"ea902132-9751-4c5c-a0ae-f60e1094074c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13971, 375, 222, 4, 68, "Section",ExpressionUUID->"80e875b1-1e31-44c6-9432-644fe51214b4"],
Cell[14196, 381, 1147, 25, 81, "Text",ExpressionUUID->"ee3448e6-f336-421a-969f-dee7c36fa892"],
Cell[15346, 408, 382, 8, 45, "Input",ExpressionUUID->"e558edde-2c19-4c17-8701-81df320758b3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15765, 421, 162, 3, 68, "Section",ExpressionUUID->"2c355881-0a0b-4a8b-ad8a-8f0f687b6ada"],
Cell[15930, 426, 502, 9, 58, "Text",ExpressionUUID->"e3e28ffc-dbf1-4f79-adb7-0b622c76c8ba"],
Cell[16435, 437, 2384, 59, 149, "Input",ExpressionUUID->"f4abc137-58b6-4bd4-9c2b-d046b2dd6711",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18856, 501, 222, 4, 68, "Section",ExpressionUUID->"86412d4e-daa1-47a9-beb5-f22fec899bc5"],
Cell[19081, 507, 17386, 465, 623, "Input",ExpressionUUID->"813d1975-4b0e-411e-8e5c-5984933fad38",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[36504, 977, 234, 6, 68, "Section",ExpressionUUID->"9772c627-8d17-4696-895c-6af71d0d2573"],
Cell[36741, 985, 11037, 264, 425, "Input",ExpressionUUID->"a9141198-4b1e-4f5d-85f1-c2c5d2b7bdbf",
 InitializationCell->True],
Cell[47781, 1251, 274, 6, 35, "Text",ExpressionUUID->"e5e3f87f-190b-4b79-9535-ee70c1f014a8"],
Cell[48058, 1259, 10410, 286, 399, "Input",ExpressionUUID->"141058ea-aa1f-4cf1-a428-5602ec837f0e",
 InitializationCell->True],
Cell[58471, 1547, 326, 12, 150, "Text",ExpressionUUID->"cc95eec7-2fbe-4ffd-9a34-afca59d524f9"],
Cell[58800, 1561, 7850, 221, 275, "Input",ExpressionUUID->"0659f1f1-dae8-4180-ad29-744c9de3bda4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[66687, 1787, 136, 3, 68, "Section",ExpressionUUID->"6b2ae15c-26c2-4d94-abda-6b7840fcbf4c"],
Cell[66826, 1792, 395, 8, 58, "Text",ExpressionUUID->"fabb721b-9dd5-40b7-8739-7339ec2e85af"],
Cell[67224, 1802, 6092, 130, 249, "Input",ExpressionUUID->"043147b7-2c35-483d-93b3-8a73f92aaded",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[73353, 1937, 196, 5, 68, "Section",ExpressionUUID->"c8e6a5c8-992b-4488-8635-a3caa7f95240"],
Cell[73552, 1944, 2720, 43, 88, "Text",ExpressionUUID->"ee97f5bd-8a26-479e-8838-49bfc5eef9e9"],
Cell[76275, 1989, 11984, 301, 597, "Input",ExpressionUUID->"76dd4960-70f1-4a03-8b8d-11cd02f91d03",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[88296, 2295, 239, 4, 68, "Section",ExpressionUUID->"5c701a5b-4a83-499a-9cf9-1e4625df1276"],
Cell[88538, 2301, 10429, 265, 435, "Input",ExpressionUUID->"3b1bd3d2-1391-471a-9fd8-3033270b50a9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[99004, 2571, 191, 3, 68, "Section",ExpressionUUID->"bce91565-ff84-47b6-9f15-65bc9f89bc4a"],
Cell[99198, 2576, 5626, 132, 252, "Input",ExpressionUUID->"b1f843fd-c530-43f6-ac4b-0da2b55eb32b",
 InitializationCell->True],
Cell[104827, 2710, 433, 7, 29, "Input",ExpressionUUID->"1e9413e1-18cc-44ea-9cf8-a181eb0c8984"],
Cell[105263, 2719, 2334, 55, 216, "Input",ExpressionUUID->"30d3021e-e02b-47ff-87d8-2096f7335fa7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107634, 2779, 229, 4, 53, "Subtitle",ExpressionUUID->"3bee6173-2860-41a4-97aa-16b4c2f03c3f"],
Cell[CellGroupData[{
Cell[107888, 2787, 149, 2, 68, "Section",ExpressionUUID->"ac4693d7-05b3-40d8-8440-ef2c344f4754"],
Cell[108040, 2791, 2086, 37, 357, "Text",ExpressionUUID->"5a432066-e762-46d7-b5d4-6a44ce9896a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110163, 2833, 79, 0, 68, "Section",ExpressionUUID->"c70b6804-918b-49f0-a4ee-a4975d0e03ef"],
Cell[CellGroupData[{
Cell[110267, 2837, 198, 5, 45, "Subsubsection",ExpressionUUID->"523c364f-a165-4891-9ced-cdecc616254e"],
Cell[110468, 2844, 410, 8, 35, "Text",ExpressionUUID->"e54cb85c-19f3-4626-ade0-d72355bd7bc5"],
Cell[110881, 2854, 2028, 60, 87, "Input",ExpressionUUID->"2cc19a80-c21f-478c-8c03-905373cf57a5",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[112946, 2919, 91, 0, 54, "Subsection",ExpressionUUID->"8c6e244c-da93-4b3c-9768-1f25e23528ae"],
Cell[113040, 2921, 20316, 406, 1531, "Input",ExpressionUUID->"e20782e1-278e-436a-803a-2d291ea0e226",
 InitializationCell->True],
Cell[133359, 3329, 242, 4, 29, "Input",ExpressionUUID->"3d241b05-e785-493b-900d-ef6a67305bdc"],
Cell[133604, 3335, 472, 13, 71, "Input",ExpressionUUID->"9d40c929-8b43-4611-b372-104b7da9662d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134113, 3353, 95, 0, 54, "Subsection",ExpressionUUID->"51952953-54de-4bd2-82dd-695439e3099f"],
Cell[134211, 3355, 10889, 201, 542, "Input",ExpressionUUID->"b920c783-e441-427a-aad5-71683f9b246e",
 InitializationCell->True],
Cell[145103, 3558, 379, 9, 51, "Input",ExpressionUUID->"0c65297c-1d79-4715-9bab-0a4cbaace970"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145531, 3573, 85, 0, 68, "Section",ExpressionUUID->"c04f9508-2949-444a-a368-e24a4426aeaf"],
Cell[CellGroupData[{
Cell[145641, 3577, 104, 0, 54, "Subsection",ExpressionUUID->"b60879b4-e09d-4f6a-9ba8-a6839efb3a44"],
Cell[145748, 3579, 4826, 124, 603, "Input",ExpressionUUID->"8b0af1d2-33e8-48d4-8d15-d11de573e27b",
 InitializationCell->True],
Cell[150577, 3705, 279, 7, 29, "Input",ExpressionUUID->"35e4b6c7-ae0e-43e8-b8c3-df5eef38b10a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150893, 3717, 130, 0, 54, "Subsection",ExpressionUUID->"ea0e0212-1d6e-4ffe-96d2-790055147bc2"],
Cell[151026, 3719, 534, 15, 67, "Input",ExpressionUUID->"12a02e8e-6f9d-4d4f-b9b2-1b670c1ed3a8",
 InitializationCell->True],
Cell[151563, 3736, 265, 6, 29, "Input",ExpressionUUID->"62f02ad5-d9f9-4d39-8dfd-080dc09f09e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151865, 3747, 161, 2, 54, "Subsection",ExpressionUUID->"68f0c5fe-5876-4aac-9004-ccb02aa1e44d"],
Cell[152029, 3751, 1914, 51, 150, "Input",ExpressionUUID->"f6cdaa36-3a23-4455-8fb1-d8054abad5c1",
 InitializationCell->True],
Cell[153946, 3804, 478, 13, 51, "Input",ExpressionUUID->"bcfc2c23-75a0-45e7-9adf-d465f3f48e4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154461, 3822, 338, 10, 54, "Subsection",ExpressionUUID->"8c7a177c-06db-446c-adcf-020c21d09376"],
Cell[154802, 3834, 15119, 375, 703, "Input",ExpressionUUID->"790ebee2-748d-478a-b999-5cfe94471880",
 InitializationCell->True],
Cell[169924, 4211, 946, 26, 92, "Input",ExpressionUUID->"5fc033e2-98ba-4e9e-b4b8-1fa3035dcab4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170907, 4242, 1234, 53, 108, "Subsection",ExpressionUUID->"2c48a524-1576-4980-8494-b5087024d737"],
Cell[172144, 4297, 45341, 1005, 3196, "Input",ExpressionUUID->"a9d7dbba-25c0-412b-8b63-18297d12ad73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[217534, 5308, 80, 0, 68, "Section",ExpressionUUID->"726f8d3c-4fc5-4b77-b365-dcdb0b1ce106"],
Cell[CellGroupData[{
Cell[217639, 5312, 171, 3, 54, "Subsection",ExpressionUUID->"65f6252c-0877-4ed2-92ba-a7443ec002c2"],
Cell[217813, 5317, 1064, 25, 133, "Input",ExpressionUUID->"e97aba38-8e3d-4e20-aa96-cfb812fdb96b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218914, 5347, 103, 0, 54, "Subsection",ExpressionUUID->"a40c2cde-ed9a-49c7-b01e-67fe6990d282"],
Cell[219020, 5349, 615, 15, 71, "Input",ExpressionUUID->"79df05b8-8495-4118-8324-609437d674ef"]
}, Open  ]],
Cell[219650, 5367, 87, 0, 54, "Subsection",ExpressionUUID->"e63364b9-80f4-4a8a-88fd-ffe3b66445f5"],
Cell[CellGroupData[{
Cell[219762, 5371, 90, 0, 38, "Subsection",ExpressionUUID->"2f4b188b-4318-4f89-9e56-583c96dce3f2"],
Cell[219855, 5373, 1797, 48, 71, "Input",ExpressionUUID->"2c8969a9-e998-409f-af0e-0da83d39b83e"],
Cell[221655, 5423, 3309, 84, 133, "Input",ExpressionUUID->"faed5a0a-b3af-42e9-ad98-e5cde78a714b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225001, 5512, 168, 3, 54, "Subsection",ExpressionUUID->"82106ae2-e064-4a6a-9af8-8e2b5c941394"],
Cell[225172, 5517, 459, 10, 51, "Input",ExpressionUUID->"3807d119-83ef-43d7-b753-43e48cf75d63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225668, 5532, 88, 0, 54, "Subsection",ExpressionUUID->"afe12438-71cd-4643-a39d-9870787159c5"],
Cell[225759, 5534, 363, 8, 29, "Input",ExpressionUUID->"79694c03-00d9-4e30-9e66-3372dc8a901e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226159, 5547, 211, 4, 54, "Subsection",ExpressionUUID->"4e36ba48-b711-4d4d-ae1b-a0cb3177a976"],
Cell[226373, 5553, 502, 10, 58, "Text",ExpressionUUID->"d5f24541-74cd-43d3-9af5-3e64f1e91bcc"],
Cell[226878, 5565, 1019, 29, 71, "Input",ExpressionUUID->"786a4436-1875-443d-91d4-096c5671f4ff"],
Cell[227900, 5596, 424, 8, 58, "Text",ExpressionUUID->"880a1b00-4e69-4f76-84f9-c0c832243510"],
Cell[228327, 5606, 2358, 51, 92, "Input",ExpressionUUID->"312d5ea0-ea08-4504-90e6-8034acbf52bb"],
Cell[230688, 5659, 331, 7, 35, "Text",ExpressionUUID->"3973cdc3-0e5e-4f52-8a51-7d71191749a6"],
Cell[231022, 5668, 236, 6, 29, "Input",ExpressionUUID->"f3942ca4-6f07-407c-b751-ad7499b62e85"],
Cell[231261, 5676, 4556, 121, 226, "Input",ExpressionUUID->"f6881afe-91a1-4ff2-9715-2ab84416bf0c"],
Cell[235820, 5799, 282, 6, 29, "Input",ExpressionUUID->"1acd4ee0-0093-4dd8-8ef7-b41b111c5894"],
Cell[236105, 5807, 228, 6, 29, "Input",ExpressionUUID->"39e86309-035a-4a8e-b082-d483f225bc93"],
Cell[236336, 5815, 734, 19, 29, "Input",ExpressionUUID->"ecced01a-36e8-4ee3-87b5-e84736459fa5"],
Cell[237073, 5836, 298, 6, 29, "Input",ExpressionUUID->"1231f56f-fb78-40d1-96d4-5d00e6fcabcc"],
Cell[237374, 5844, 580, 13, 51, "Input",ExpressionUUID->"383a13aa-3269-4c84-8475-38ced108af13"],
Cell[237957, 5859, 11502, 288, 422, "Input",ExpressionUUID->"3ead0ed2-e28f-4782-bd9b-6c206f6df93d"],
Cell[249462, 6149, 412, 10, 49, "Input",ExpressionUUID->"d35589b1-4db1-43e6-b710-e42f422b6fe6"],
Cell[249877, 6161, 182, 4, 29, "Input",ExpressionUUID->"0ae7a97e-2c59-42e1-959f-8014f36125cc"],
Cell[250062, 6167, 2326, 62, 107, "Input",ExpressionUUID->"121f09c6-b117-4d55-b8b9-ecaf53d88fd7"],
Cell[252391, 6231, 172, 4, 29, "Input",ExpressionUUID->"30753ba2-09b1-4a0b-8dc3-6c5c63f1ee4e"],
Cell[252566, 6237, 1762, 40, 52, "Input",ExpressionUUID->"66527279-fb19-4822-bb16-a055ae4a4722"],
Cell[254331, 6279, 167, 4, 29, "Input",ExpressionUUID->"25541f34-225f-4d7f-b45f-ed563fa17fe3"],
Cell[254501, 6285, 1265, 32, 51, "Input",ExpressionUUID->"614008a9-7dcd-4eb4-b86c-b0c06aa5b6b2"],
Cell[255769, 6319, 519, 10, 29, "Input",ExpressionUUID->"9e121602-01d8-4d46-ac17-fc630ace6e1d"],
Cell[256291, 6331, 4227, 103, 163, "Input",ExpressionUUID->"db5aec5d-798c-48b6-a1d7-d9b378d49f48"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

